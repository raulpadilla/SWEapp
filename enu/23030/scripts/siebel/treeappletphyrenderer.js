/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2013 Oracle and/or its affiliates. All rights reserved.
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
if(typeof(SiebelAppFacade.TreeAppletPR)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.TreeAppletPR");define("siebel/treeappletphyrenderer",["order!3rdParty/jstree/jquery.jstree","3rdParty/accessible-jqui/jquery.hotkeys"],function(){SiebelAppFacade.TreeAppletPR=(function(){var h=SiebelJS.Dependency("SiebelApp.Utils");var e=SiebelJS.Dependency("SiebelApp.Constants");function b(m){SiebelAppFacade.TreeAppletPR.superclass.constructor.call(this,m);var l=false;this.SetPending=function(p){l=p};this.IsPending=function(){return l};var n=false;this.SetReady=function(){n=true};this.IsReady=function(){return n};var o=false;this.SetLateBinding=function(p){o=p};this.IsLateBinding=function(){return o}}SiebelJS.Extend(b,SiebelAppFacade.BasePR);b.prototype.Init=function(){SiebelAppFacade.TreeAppletPR.superclass.Init.call(this);this.AttachPMBinding("refreshTree",this.BindData);this.AttachPMBinding("cleartree",c);this.AttachPMBinding("FocusSelectedTreeNode",function(m){var n=this.GetPM();var p=n.Get("placeholder");var l="#"+n.Get("selectednode").position;l=l.replace(/\./gi,"\\.");var o=$("#"+p).jstree("get_selected");$("#"+p).jstree("deselect_node",o);$("#"+p).jstree("select_node",l);$(l).addClass("siebel-selectednode");$(l).attr("role","presentation");$(l).children("a").attr("aria-selected","true")})};b.prototype.ShowUI=function(){SiebelAppFacade.TreeAppletPR.superclass.ShowUI.call(this);i.call(this);var n=this.GetPM().Get("placeholder");var m=$("#s_"+this.GetPM().Get("GetFullId")+"_div");var l=SiebelApp.S_App.GetDirection();if(h.IsTrue(SiebelApp.S_App.GetAccessibilityEnhanced())){m.attr({role:"region",title:this.GetPM().Get("LandMarkTitle")})}$("#"+n).jstree({rules:{deletable:"all"},themes:{theme:(l?"default-rtl":"default")},core:{rtl:(l?true:false)},plugins:["ui","themes","html_data","hotkeys","crrm"]});$("#"+n).jstree("clear_bindingflag");g.call(this)};function g(){var m=$("#s_"+this.GetPM().Get("GetFullId")+"_div");var l=this.GetPM();if((m.length!=0)&&l){if(typeof(l.Get("GetObjectType"))==="string"){$(m).attr("ot",l.Get("GetObjectType"))}if(typeof(l.Get("GetRepstrName"))==="string"){$(m).attr("rn",l.Get("GetRepstrName"))}if(typeof(l.Get("GetUIName"))==="string"){$(m).attr("un",l.Get("GetUIName"))}}}b.prototype.BindEvents=function(){SiebelAppFacade.TreeAppletPR.superclass.BindEvents.call(this);var l=this.GetPM();var n=l.Get("placeholder");var m=this;$("#"+n).bind("reopen.jstree",function(q,p){var o="#"+l.Get("selectednode").position.replace(/\./gi,"\\.");$("#"+n).jstree("select_node",o)});$("#"+n).bind("close_node.jstree",function(p,o){if(o.args.length===1){l.OnControlEvent("OnTreeEvent","CollapseTreeItem",o.args[0][0].id)}});$("#"+n).bind("open_node.jstree",function(r,q){if(q.args.length===1){var s=q.args[0][0].id;var o=l.Get("root");var p=j.call(m,s,o);if(m.IsLateBinding()){p.expand="t";a.call(m,p,n)}l.OnControlEvent("OnTreeEvent","ExpandTreeItem",s)}});$("#"+n).bind("hover_node.jstree",function(q,o){var p=$(o.rslt.obj[0]);if(!p||!p.length){return false}p.children("a").attr("tabindex","0").focus()});$("#"+n).bind("dehover_node.jstree",function(q,o){var p=$(o.rslt.obj[0]);if(!p||!p.length){return false}p.children("a").attr("tabindex","-1")});$("#"+n).bind("loaded.jstree",{ctx:this},function(q,p){var o=q.data.ctx;o.SetReady();if(o.IsPending()){o.SetPending(false);o.BindData()}});$("#"+n).bind("click",function(q,r){q.stopImmediatePropagation();if(q.target.nodeName==="A"){l.ExecuteMethod("SetCurrentNode",$(q.target).parent("li")[0].id);var p=l.Get("currentnode").type;var o="";if(p===e.get("TREENODE_TYPE_NEXT")){o="NextTreeItem"}else{if(p===e.get("TREENODE_TYPE_PREV")){o="PreviousTreeItem"}else{o="SelectTreeItem"}}l.OnControlEvent("OnTreeEvent",o,$(q.target).parent("li")[0].id)}})};function j(l,m){var o=null;if(m.position===l){return m}for(var n=0;n<m.child.length;n++){if(m.child[n].position===l){return m.child[n]}}for(var n=0;n<m.child.length;n++){if(m.child[n].child.length>0){o=j.call(this,l,m.child[n]);if(o!=null){return o}}}return null}function k(l,m){var o=j.call(this,l,m);var n;if(o==null){return null}while(o.parent&&o.parent.position!="0"){n=o.parent;n.expand="t";o=o.parent}return n}function c(){var o=this.GetPM();var m=o.Get("root");SiebelJS.Log((new Date()).toLocaleString()+": Tree:Cleartree:begin");if(m&&m.child){for(var n=0;n<=m.child.length-1;n++){var l=m.child[n];d.call(this,l)}}SiebelJS.Log((new Date()).toLocaleString()+": Tree:Cleartree:end")}function d(m){var o=this.GetPM();var l=m.child;var q=o.Get("placeholder");for(var n=0;n<=l.length-1;n++){var p="#"+l[n].position;p=p.replace(/\./gi,"\\.");$("#"+q).jstree("remove",p)}$("#"+q).jstree("deselect_node","#1")}b.prototype.BindData=function(){SiebelAppFacade.TreeAppletPR.superclass.BindData.call(this);if(!this.IsReady()){this.SetPending(true);return}SiebelJS.Log((new Date()).toLocaleString()+": Tree:BindData:begin");var l=this.GetPM();var s=l.Get("root");var r=l.Get("placeholder");var o=l.Get("nodecount");if(o>200){this.SetLateBinding(true)}else{this.SetLateBinding(false)}if(s&&s.child){for(var n=0;n<=s.child.length-1;n++){var q=s.child[n];a.call(this,q,r);var p=q.position.replace(/\./gi,"\\.");$("div#"+r+" ul li#"+p).children("a").attr("aria-expanded",(!h.IsEmpty(q.expand)&&q.expand==="t"))}var t="#"+l.Get("selectednode").position.replace(/\./gi,"\\.");var m=k.call(this,l.Get("selectednode").position,s);if(this.IsLateBinding()){a.call(this,m,r)}$("#"+r).jstree("select_node",t);$(t).addClass("siebel-selectednode").attr("role","presentation").children("a").attr("aria-selected","true").attr("tabindex","0").focus()}SiebelJS.Log((new Date()).toLocaleString()+": Tree:BindData:end")};function i(){var o=this.GetPM();var q=o.Get("placeholder");$("#"+q).jstree("destroy");var m=o.Get("root");for(var n=0;n<=m.child.length-1;n++){var l=m.child[n];var p='<ul role="group" ><li role="presentation" id ="'+l.position+'"><a role="treeitem" href="#">'+l.caption+"</a></li></ul>";$("#"+q).append(p)}}function f(m,l){var n=l.match(/siebel\-icon[^\s]+/g)||[];return(n.join(" "))}function a(s,t){var v=(this.IsLateBinding()&&s.expand!="t");var u="#"+s.position.replace(/\./gi,"\\.");for(var q=0;q<=s.child.length-1;q++){if(q>0&&v){break}var r="#"+s.child[q].position.replace(/\./gi,"\\.");var l=$(r);if(l.length>0){continue}$("#"+t).attr("role","group");$("#"+t).jstree("create",u,"last",{attr:{id:s.child[q].position},data:{title:s.child[q].caption}},"",true);$(r).attr("role","presentation");if(q===0){$(r).parent().attr("role","group")}$(r).children("ins").attr("role","presentation");$(r).children("ins").attr("aria-hidden","true");$(r).children("a").attr("role","treeitem").attr("tabindex","-1").attr("aria-expanded","true");if(s.child[q].type===e.get("TREENODE_TYPE_NEXT")){var p="#"+s.child[q].position.replace(/\./gi,"\\.");$(p).addClass("siebel-nextpage")}else{if(s.child[q].type===e.get("TREENODE_TYPE_PREV")){var m="#"+s.child[q].position.replace(/\./gi,"\\.");$(m).addClass("siebel-prevpage")}}if(!h.IsEmpty(s.child[q].icon)){var n="#"+s.child[q].position.replace(/\./gi,"\\.");
$(n).removeClass(f);$(n).addClass("siebel-icon-"+s.child[q].icon)}if(s.child[q].child.length>0){a.call(this,s.child[q],t)}else{$(r).removeClass("jstree-open").addClass("jstree-leaf");$(r).children("a").removeAttr("aria-expanded");$(r).removeClass("jstree-open").addClass("jstree-leaf")}}if(h.IsEmpty(s.expand)){var o=s.position.replace(/\./gi,"\\.");$("div#"+t+" ul li[id="+o+"]").removeClass("jstree-open").addClass("jstree-closed").children("a").attr("aria-expanded","false")}}b.prototype.ShowSelection=function(){};b.prototype.SetHighlightState=function(){};b.prototype.FocusFirstControl=function(){};b.prototype.UpdateUIButtons=function(){};return b}());return"SiebelAppFacade.TreeAppletPR"})};
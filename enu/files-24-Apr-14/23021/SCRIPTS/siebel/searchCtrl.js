if(typeof(SiebelAppFacade.SearchCtrl)=="undefined"){SiebelJS.Namespace("SiebelAppFacade.SearchCtrl");SiebelAppFacade.SearchCtrl=(function(){var g=SiebelApp.Constants;function h(k){var n;var j=$();var m;var l;this.SetContainer=function(o){j=o};this.GetContainer=function(){return j};this.GetRenderer=function(){return k};this.SetColumnId=function(o){n=o};this.GetColumnId=function(){return n};this.SetFields=function(o){m=o};this.GetFields=function(){return m};this.SetAppletContainer=function(o){l=o};this.GetAppletContainer=function(){return l}}h.prototype.GetInputField=function(){return $(this.GetContainer()).find("input.searchInput")};h.prototype.GetSearchField=function(){return $(this.GetContainer()).find("select.searchField")};h.prototype.RemovePopup=function(){var k=false;var j=$(this.GetContainer()).find("div.floatToolbar");if(j.length!==0){$(j).remove();k=true}return k};h.prototype.ShowUI=function(n,j){this.SetContainer($("#"+j).parent().parent().parent().find("div.SearchCtrl")[0]||$("#"+j).parents("td.AppletStylePopup").find("div.SearchCtrl")[0]);if($("#"+j).parents("div.siebui-view-multi-column").length===0){var s="";for(var m=0,o=n.length;m<o;m++){s+="<option "+(m===0?"selected":"")+">"+n[m]+"</option>"}var u=SiebelApp.S_App.LocaleObject;var t=u.GetLocalString("IDS_SWE_SEARCH_TEXT_TITLE");var r=u.GetLocalString("IDS_SWE_SEARCH_FIELD_TITLE");var k='<div id="'+j+'_searchContainer" class="searchContainer" ><input id="'+j+'_searchInput" class="searchInput" title="'+t+'" /><select id="'+j+'_searchField" class="searchField" title="'+r+'">'+s+"</select></div>";$(this.GetContainer()).append(k);this.GetInputField().bind("focus",{ctx:this},b).bind("blur",{ctx:this},f).bind("keydown",{ctx:this},e).val(SiebelApp.S_App.LocaleObject.GetLocalString("IDS_SWE_SEARCH_WATER_MARK"))}else{this.SetFields(n);this.SetAppletContainer(j);var q=this.GetRenderer().GetPM().Get("GetAppletLabel");if(q!==""){q=q+":"}var l=SiebelApp.S_App.LocaleObject.GetLocalString("IDS_SWE_JQGRID_SEARCH_CAPTION");var p='<div id="'+j+'_searchButtonContainer" class="appletButton searchContainer searchButton" tabindex="0"title="'+q+l+'" ><img id="'+j+'_searchButton" alt='+l+'" src="images/icon_fastsearch.gif" class="searchButton" /></div>';$(this.GetContainer()).append(p);$(this.GetContainer()).find("div.searchButton").bind("click",{ctx:this},i).bind("keydown",{ctx:this},c)}};function b(l){var k=l.data.ctx;if($(this).val()==SiebelApp.S_App.LocaleObject.GetLocalString("IDS_SWE_SEARCH_WATER_MARK")){$(this).val("")}var j=k.GetRenderer().GetPM();j.OnControlEvent(g.get("PHYEVENTS_APPLET_FOCUS"))}function f(j){if(!$(this).val()){$(this).val(SiebelApp.S_App.LocaleObject.GetLocalString("IDS_SWE_SEARCH_WATER_MARK"))}}function e(n){var l=n.data.ctx;if(n.which===$.ui.keyCode.ESCAPE){l.RemovePopup();$(l.GetContainer()).find("div.searchButton").focus();return false}else{if(n.which===$.ui.keyCode.ENTER){var o=l.GetInputField().attr("value");var j={};var m=l.GetRenderer().GetPM().Get("ListOfColumns");for(var k=0;k<m.length;k++){if(m[k].control.GetDisplayName()===$(l.GetSearchField()).val()){var p=m[k].control.GetSpanPrefix()+"0";l.SetColumnId(p);l.GetRenderer().GetPM().AddProperty("SearchColumnId",p);l.GetRenderer().GetPM().AddProperty("SearchValue",o);l.GetRenderer().GetPM().AddProperty("SearchField",m[k].control.GetName());break}}j[l.GetSearchField().val()]=o;l.GetRenderer().GetPM().ExecuteMethod("Query",j);l.RemovePopup();$(l.GetContainer()).find("div.searchButton").focus();return false}}}function i(k){var j=k.data.ctx;if(!j.RemovePopup()){d(j,this)}}function c(k){if((k.which===$.ui.keyCode.ENTER)||(k.which===SiebelApp.Constants.get("SWE_F2_KEY"))){var j=k.data.ctx;d(j,this);return false}}function d(p,n){var m=p.GetFields();var j=p.GetAppletContainer();var r="";for(var l=0,o=m.length;l<o;l++){r+="<option "+(l===0?"selected":"")+">"+m[l]+"</option>"}var t=SiebelApp.S_App.LocaleObject;var s=t.GetLocalString("IDS_SWE_SEARCH_TEXT_TITLE");var q=t.GetLocalString("IDS_SWE_SEARCH_FIELD_TITLE");var k='<div id="'+j+'_searchPopup" class="floatToolbar searchButton" tabindex="-1"><input id="'+j+'_searchInput" class="searchInput" title="'+s+'" /><select id="'+j+'_searchField" class="searchField" title="'+q+'">'+r+"</select></div>";$(n).parent().append(k);$(n).parent().find("div.floatToolbar").bind("click",{ctx:p},a);$(n).parent().find("input.searchInput").bind("focus",{ctx:p},b).bind("blur",{ctx:p},f).bind("keydown",{ctx:p},e).focus()}function a(j){$(this).find("input.searchInput").focus();return false}return h}())};
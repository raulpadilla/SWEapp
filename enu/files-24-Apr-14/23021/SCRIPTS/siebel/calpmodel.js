if(typeof(SiebelAppFacade.CalPresentationModel)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.CalPresentationModel");if(typeof(SiebelApp)!=="undefined"&&typeof(SiebelApp.S_App)!=="undefined"){if(typeof(SiebelApp.Constants)!=="undefined"){SiebelApp.S_App.RegisterConstructorAgainstKey(SiebelApp.Constants.get("SWE_UIDEF_CALAPPLET_PMODEL"),"SiebelAppFacade.CalPresentationModel")}}SiebelAppFacade.CalPresentationModel=(function(){var g=SiebelJS.Dependency("SiebelApp.Constants");function m(n){SiebelAppFacade.CalPresentationModel.superclass.constructor.call(this,n)}SiebelJS.Extend(m,SiebelAppFacade.PresentationModel);m.prototype.Init=function(){SiebelAppFacade.CalPresentationModel.superclass.Init.call(this);this.AddMethod("PopulatePropSet",b);this.AddMethod("UpdateUserPermission",h);this.AddMethod("ParseEventInfoOUI",a);this.AttachEventHandler(g.get("PHYEVENT_DRILLDOWN"),function(n){this.ExecuteMethod("InvokeMethod","DrillDown",f.call(this,n))});this.AttachEventHandler("eventResize",function(q,n,p,o){l.call(this,q,n,p,o,"eventResize")});this.AttachEventHandler("eventDrop",function(q,n,p,o){l.call(this,q,n,p,o,"eventDrop")});this.AttachEventHandler("newEvent",function(p,n,o){d.call(this,p,n,o)});this.AttachEventHandler("newLSCall",function(n){i.call(this,n)});this.AttachNotificationHandler(g.get("SWE_PROP_BC_NOTI_GENERIC"),function(n){c.call(this,n)})};m.prototype.Setup=function(n){SiebelAppFacade.CalPresentationModel.superclass.Setup.call(this,n);var t=n.EnumChildren(true);do{if(t.GetType()===g.get("SWE_PST_CNTRL_LIST")){var o=t.EnumChildren(true);do{if(o.GetType()===g.get("SWE_PST_CUSTOM_CTRL")){k.call(this,o.GetChild(0));break}}while(o=t.EnumChildren(false));break}}while(t=n.EnumChildren(false));var r=[this.Get("UISTR January"),this.Get("UISTR February"),this.Get("UISTR March"),this.Get("UISTR April"),this.Get("UISTR May"),this.Get("UISTR June"),this.Get("UISTR July"),this.Get("UISTR August"),this.Get("UISTR September"),this.Get("UISTR October"),this.Get("UISTR November"),this.Get("UISTR December")];var s=[this.Get("UISTR Jan"),this.Get("UISTR Feb"),this.Get("UISTR Mar"),this.Get("UISTR Apr"),this.Get("UISTR May"),this.Get("UISTR Jun"),this.Get("UISTR Jul"),this.Get("UISTR Aug"),this.Get("UISTR Sep"),this.Get("UISTR Oct"),this.Get("UISTR Nov"),this.Get("UISTR Dec")];var p=[this.Get("UISTR Sunday"),this.Get("UISTR Monday"),this.Get("UISTR Tuesday"),this.Get("UISTR Wednesday"),this.Get("UISTR Thursday"),this.Get("UISTR Friday"),this.Get("UISTR Saturday")];var q=[this.Get("UISTR Su"),this.Get("UISTR Mo"),this.Get("UISTR Tu"),this.Get("UISTR We"),this.Get("UISTR Th"),this.Get("UISTR Fr"),this.Get("UISTR Sa")];this.AddProperty("CurViewStartDate",new Date());this.AddProperty("CurViewEndDate",new Date());this.AddProperty("CurViewShowDate",new Date());this.AddProperty("EventInfo",[]);this.AddProperty("Timezone",this.Get("Default Timezone"));this.AddProperty("MonthStringArray",r);this.AddProperty("MonthShortStringArray",s);this.AddProperty("WeekDayStringArray",p);this.AddProperty("WeekDayShortStringArray",q);this.AddProperty("Owner",this.Get("Default User"));h.call(this)};function k(n){var o=n.EnumProperties(true);do{this.AddProperty(o,n.GetProperty(o))}while(o=n.EnumProperties(false));j.call(this)}function j(){if(!this.Get("Enable Monthly Time Display")){this.AddProperty("Enable Monthly Time Display","Always")}if(!this.Get("Enable 5Day Time Display")){this.AddProperty("Enable 5Day Time Display","Off-interval")}if(!this.Get("Enable Daily Time Display")){this.AddProperty("Enable Daily Time Display","Off-interval")}if(!this.Get("SelectedDate")){this.AddProperty("SelectedDate",new Date())}}function h(){var n=this.Get("Owner");if(this.Get("Enable Owner Picker")==="Y"){if(!n){this.AddProperty("Owner",this.Get("User Login Name"))}}else{this.AddProperty("Owner","")}var p=this.Get("Update List");if(p!==""){var o=CCFMiscUtil_CreatePropSet();o.DecodeFromString(p);if(o.GetProperty(this.Get("Owner"))){this.AddProperty("CanInsert",this.Get("No Insert")!=="Y");this.AddProperty("CanUpdate",this.Get("No Update")!=="Y")}else{this.AddProperty("CanInsert",false);this.AddProperty("CanUpdate",false)}}}function c(n){var s=n.GetProperty(g.get("SWE_PROP_NOTI_TYPE"));if(n.GetProperty(g.get("SWE_PROP_NOTI_TYPE"))==="HICalendarData"){var q=n.GetProperty(g.get("SWE_PROP_ARGS_ARRAY"));var r=[];if(q){CCFMiscUtil_StringToArray(q,r)}var o=CCFMiscUtil_CreatePropSet();for(var p=0;p<r.length;p++){o.SetProperty(p.toString(),r[p])}this.ExecuteMethod("ParseEventInfoOUI",o)}}function f(s){var n=CCFMiscUtil_CreatePropSet();var r=s.split("('");r=r[1].split("')");var q=r[0];n.SetProperty("Data",q);var o=this.Get("CurViewShowDate");var p=(o.getMonth()+1)+"/"+o.getDate()+"/"+o.getFullYear();n.SetProperty("CurrentDate",p);n.SetProperty("SelectedDate",this.Get("SelectedDate").getTime());return n}function l(s,o,r,q,p){var n=CCFMiscUtil_CreatePropSet();n.SetProperty("NewStartDate",s);n.SetProperty("RowId",r);if(p==="eventResize"){n.SetProperty("NewEndDate",o)}if(q){n.SetProperty("Optional",q.EncodeAsString())}this.ExecuteMethod("InvokeMethod","UpdateRecord",n)}function d(t,p,r){var q=new Date(p);var s=new Date(r);var o=CCFMiscUtil_CreatePropSet();o.SetProperty("StartDate",$.fullCalendar.formatDate(q,"MM/dd/yyyy HH:mm:ss"));o.SetProperty("EndDate",$.fullCalendar.formatDate(s,"MM/dd/yyyy HH:mm:ss"));o.SetProperty("CurrentDate",$.fullCalendar.formatDate(q,"MM/dd/yyyy"));if(t.length>0){var n=this.Get("DescriptionFieldLength");t=t.substring(0,n);o.SetProperty("Description",t)}this.ExecuteMethod("InvokeMethod","NewRecord",o)}function i(p){var o;if(p==="Contact"){o="NewProfCall"}else{if(p==="Account"){o="NewAcctCall"}else{if(p==="Meeting"){o="NewMeeting"}else{return}}}var n=CCFMiscUtil_CreatePropSet();n.SetProperty("StartDate",$.fullCalendar.formatDate(this.Get("SelectedDate"),"MM/dd/yyyy HH:mm:ss"));n.SetProperty("CurrentDateTime",$.fullCalendar.formatDate(new Date(),"MM/dd/yyyy HH:mm:ss"));this.ExecuteMethod("InvokeMethod",o,n)}function b(){var p=this.Get("CurViewStartDate");var o=(p.getMonth()+1)+"/"+p.getDate()+"/"+p.getFullYear();var u=this.Get("CurViewEndDate");var s=(u.getMonth()+1)+"/"+u.getDate()+"/"+u.getFullYear();var t=this.Get("CurViewShowDate");var q=(t.getMonth()+1)+"/"+t.getDate()+"/"+t.getFullYear();var r=t.getTime();var n=CCFMiscUtil_CreatePropSet();n.SetProperty("ViewMode",this.Get("ViewMode"));n.SetProperty("ClippingCount","4");n.SetProperty("SelectedDate",this.Get("SelectedDate").getTime());n.SetProperty("StartDate",o);n.SetProperty("EndDate",s);n.SetProperty("CurrentDate",q);n.SetProperty("StretchCell",this.Get("StretchCell"));n.SetProperty("SelectedTimeZone",this.Get("Timezone"));n.SetProperty("SelectedUser",this.Get("Owner"));return n}function a(p){var o=CCFMiscUtil_CreatePropSet();var s=CCFMiscUtil_CreatePropSet();var n=o.DecodeFromString(p.GetProperty("0"));if(n===false||o.type!=="OUICalendarData"){return}if(o.PropertyExists("ReturnStartDate")){this.AddProperty("ReturnStartDate",o.GetProperty("ReturnStartDate"))
}if(o.PropertyExists("ViewMode")){this.AddProperty("ViewMode",o.GetProperty("ViewMode"))}if(o.PropertyExists("DescriptionFieldLength")){this.AddProperty("DescriptionFieldLength",o.GetProperty("DescriptionFieldLength"))}this.AddProperty("Timezone",o.GetProperty("SelectedTimeZone"));this.AddProperty("Owner",o.GetProperty("SelectedUser"));this.AddProperty("SelectedDate",new Date(parseInt(o.GetProperty("SelectedDate"),10)));var t=[];for(var q=0;q<o.GetChildCount("CalendarEvent");q++){s=o.GetChild(q);if(s.type!=="CalendarEvent"){continue}var r=[];var u=s.EnumProperties(true);do{r[u]=s.GetProperty(u)}while(u=s.EnumProperties(false));r.DisplayField=e.call(this,s);t.push(r)}this.AddProperty("EventInfo",t)}function e(n){var o=CCFMiscUtil_CreatePropSet();var t=[];var s=n.GetChildCount("DisplayField");for(var q=0;q<s;q++){o=n.GetChild(q);if(o.type!=="DisplayField"){continue}var r=[];r.Name=o.value;r.Sequence=o.GetProperty("Sequence");r.FieldValue=o.GetProperty("FieldValue");r.FieldColor=o.GetProperty("FieldColor");r.ToolTip=o.GetProperty("ToolTip");r.IconFile=o.GetProperty("IconFile");var p=o.GetProperty("DrillDown");if(p!==""){p=p.replace(/%2f/g,"/");p=p.replace(/%23/g,"#");p="javaScript:void(0)('"+p+"')"}r.DrillDown=p;t.push(r)}return t}return m}())};
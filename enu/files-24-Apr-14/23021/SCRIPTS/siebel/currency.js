if(typeof(SiebelApp.S_App.Currency)==="undefined"){SiebelJS.Namespace("SiebelApp.S_App.Currency");SiebelApp.S_App.Currency=(function(){var a=SiebelJS.Dependency("SiebelApp.Utils");var f=SiebelJS.Dependency("SiebelApp.Constants");var e=207;var d=208;var c=209;function b(){var u=null;var s;var C;var y;var E;var B;var x;var k;var A;var i;var r=false;var q;var w;var F;var I;var z;var j;var t;var g;var D;var H;var p;var h;var n=true;var m;var v;var l;var G=false;var o;this.isShowingPick=function(){return G};this.SetShowingPick=function(J){G=J};this.GetEDateFieldName=function(){return i};this.SetEDateFieldName=function(J){i=J};this.GetCCodeMethod=function(){return B};this.SetCCodeMethod=function(J){B=J};this.GetCCodeFieldName=function(){return E};this.SetCCodeFieldName=function(J){E=J};this.GetPopupBM=function(){return g};this.SetPopupBM=function(J){g=J};this.GetRowID=function(){return t};this.SetRowID=function(J){t=J};this.GetCurrentView=function(){return z};this.SetCurrentView=function(J){z=J};this.GetCurrencySign=function(){return u};this.SetCurrencySign=function(J){u=J};this.SetEDateLabel=function(J){s=J};this.GetEDateLabel=function(){return s};this.SetAmountLabel=function(J){C=J};this.GetAmountLabel=function(){return C};this.SetCCodeLabel=function(J){y=J};this.GetCCodeLabel=function(){return y};this.CanDisplayDate=function(){return r};this.HideExchDate=function(){r=true};this.GetCurrencyApplet=function(){return j};this.SetCurrencyApplet=function(J){j=J};this.SetCurrencyControl=function(J){D=J};this.GetCurrencyControl=function(){return D};this.SetDateControlName=function(J){H=J};this.GetDateControlName=function(){return H};this.SetCalculatorControlName=function(J){p=J};this.GetCalculatorControlName=function(){return p};this.SetCurcyCode=function(J){x=J};this.GetCurcyCode=function(){return x};this.SetExchDate=function(J){q=J};this.GetAmountValue=function(){return w};this.SetAmountValue=function(J){w=J};this.GetExchDate=function(){return q};this.SetEDateReadOnly=function(J){A=J};this.IsDateReadOnly=function(){return A};this.SetCCodeReadOnly=function(J){k=J};this.IsCCodeReadOnly=function(){return k};this.SetAmountReadOnly=function(J){F=J};this.IsAmountReadOnly=function(){return F};this.SaveCurrentValues=function(){m=this.GetCurcyCode();v=this.GetExchDate();l=this.GetAmountValue()};this.GetOrigCCode=function(){return m};this.GetOrigEDate=function(){return v};this.GetOrigAmount=function(){return l};this.SetSourceField=function(J){o=J};this.GetSourceField=function(){return o}}b.prototype.GetCurrencyCalInfo=function(){var g=[];g.push(this.GetCurrencyControl());g.push(this.GetCCodeLabel());g.push(this.GetCurcyCode());g.push(this.GetDateControlName());g.push(this.GetEDateLabel());g.push(this.GetExchDate());g.push(this.GetCalculatorControlName());g.push(this.GetAmountLabel());g.push(this.GetAmountValue());g.push(this.CanDisplayDate());g.push(this.IsCCodeReadOnly());g.push(this.IsDateReadOnly());g.push(this.IsAmountReadOnly());g.push(this.GetSourceField());return g};b.prototype.UpdateCurrencyInfo=function(g,h){this.Update(g,h);if(g===2){return}return};b.prototype.Update=function(g,h){switch(g){case 0:this.Reconfig(h);break;case 1:this.UpdateCCode(h);break;default:break}this.SetShowingPick(false);this.SaveCurrentValues();return};b.prototype.UpdateCCode=function(i){var h=6;var g=[];CCFMiscUtil_StringToArray(i,g);this.SetCurcyCode(g[h-1]);this.SetCurrencySign(g[h]);this.SetAmount(this.GetAmountValue(),false);$("[name="+this.GetSourceField()+"]").val(this.GetAmountValue());this.PostChanges()};b.prototype.PostChanges=function(){if(!(this.isValuesChanged())){return}var g=CCFMiscUtil_CreatePropSet();g=this.SetDefaultParams();g=this.SetValueParams(g);var h=CCFMiscUtil_CreatePropSet();g.SetProperty("SWEMethod","PostChanges");SiebelApp.S_App.CallServer(g,h,false);this.SaveCurrentValues()};b.prototype.WriteRecord=function(){if(!(this.isValuesChanged())){return}var g=CCFMiscUtil_CreatePropSet();var h=CCFMiscUtil_CreatePropSet();g=this.SetDefaultParams();g=this.SetValueParams(g);g.SetProperty(f.get("SWE_METHOD_STR"),"WriteRecord");SiebelApp.S_App.CallServer(g,h,true);this.SaveCurrentValues()};b.prototype.CloseServerApplet=function(){if(this.isValuesChanged()){return}var g=CCFMiscUtil_CreatePropSet();var h=CCFMiscUtil_CreatePropSet();g=this.SetDefaultParams();g=this.SetValueParams(g);g.SetProperty(f.get("SWE_METHOD_STR"),"CloseApplet");SiebelApp.S_App.CallServer(g,h,true)};b.prototype.SetValueParams=function(m){if($("#"+this.GetCCodeFieldName()).length>0){var g=$("#"+this.GetCCodeFieldName()).val();var j=$("#"+this.GetEDateFieldName()).val();var l=$("#"+this.GetCalculatorControlName()).val();this.SetCurcyCode(g);this.SetExchDate(j);this.SetAmount(l,false)}m.SetProperty(this.GetCCodeFieldName(),this.GetCurcyCode());if(!(this.CanDisplayDate())){m.SetProperty(this.GetEDateFieldName(),this.GetExchDate())}var h=this.GetAmountValue();var k=0;while(isNaN(h.charAt(k))){k++}h=h.substring(k);m.SetProperty(this.GetCalculatorControlName(),h);return m};b.prototype.Reconfig=function(A){var B=[];CCFMiscUtil_StringToArray(A,B);var u=0;var r=B[u++];var s=B[u++];var y=B[u++];var h=B[u++];var v=B[u++];var o=B[u++];var g=B[u++];var l=B[u++];var x=B[u++];var p=B[u++];var w=(B.length)-1;var z;var k;this.SetCurrencySign(B[w]);this.SetCurrentView(s);this.SetCurrencyApplet(h);this.SetRowID(o);this.SetPopupBM(g);this.SetSourceField(v);var n;var m=-1;var q;for(var t=u;t<w;t++){q=B[t].split("|");if(q.length>0){switch(Number(q[0])){case 1:this.ReinitControl(d,q);this.SetCurrencyControl(q[4]);break;case 2:m=t;this.ReinitControl(c,q);this.SetDateControlName(q[4]);break;case 3:n=t;this.SetCalculatorControlName(q[4]);break;case 4:z=q[1];break;case 5:k=q[1];break;case 6:this.SetCCodeLabel(q[1]);break;case 7:this.SetEDateLabel(q[1]);break;case 8:this.SetAmountLabel(q[1]);break;default:break}}}if(n>-1){q=B[n].split("|");this.ReinitControl(e,q)}if(m<0){this.HideExchDate()}return};b.prototype.ReinitControl=function(i,q){var l=1;var p=q[l++];var k=q[l++];var n=q[l++];var m=q[l++];var g=q[l++];var o=q[l++];var r=q[l++];var h=false;if(k==="false"){h=true}if(i===d){this.SetCurcyCode(p);this.SetCCodeFieldName(m);this.SetCCodeMethod(g);this.SetCCodeReadOnly(h)}else{if(i===c){this.SetExchDate(p);this.SetEDateReadOnly(h);if(n===true){this.HideExchDate()}this.SetEDateFieldName(m)}else{if(i===e){this.SetAmount(p,false);this.SetAmountReadOnly(h);this.SetCalculatorControlName(m)}}}return};b.prototype.SetDefaultParams=function(){var g=CCFMiscUtil_CreatePropSet();g.SetProperty("SWECmd","InvokeMethod");g.SetProperty("SWEView",this.GetCurrentView());g.SetProperty(f.get("SWE_APPLET_STR"),this.GetCurrencyApplet());g.SetProperty("SWERowId",this.GetRowID());g.SetProperty("SWERowIds:SWERowId0",this.GetRowID());g.SetProperty("SWEReqRowId","true");g.SetProperty("SWENeedContext","false");g.SetProperty("SWEDIC","true");g.SetProperty("SWEP",this.GetPopupBM());g.SetProperty("SWESP","true");g.SetProperty("SWEActiveApplet","");g.SetProperty("SWEActiveView",this.GetCurrentView());
return g};b.prototype.ShowPickPopup=function(g){var h=CCFMiscUtil_CreatePropSet();var i=CCFMiscUtil_CreatePropSet();h=this.SetDefaultParams();h.SetProperty("SWEMethod",this.GetCCodeMethod());h.SetProperty("SWEField",this.GetCCodeFieldName());h.SetProperty(f.get("SWE_METHOD_STR"),"EditField");SiebelApp.S_App.CallServer(h,i,true);this.SetShowingPick(true)};b.prototype.isValuesChanged=function(){return((this.GetOrigCCode()!==this.GetCurcyCode())||(this.GetOrigEDate()!==this.GetExchDate())||(this.GetOrigAmount()!==this.GetAmountValue()))};b.prototype.NotifyClosePopup=function(){this.GetNewValues();if(!this.isShowingPick()){if(this.isValuesChanged()){this.WriteRecord()}else{this.CloseServerApplet()}}};b.prototype.GetNewValues=function(){if($("#"+this.GetCCodeFieldName()).length===1){var g=$("#"+this.GetCCodeFieldName()).val();var h=$("#"+this.GetEDateFieldName()).val();var i=$("#"+this.GetCalculatorControlName()).val();this.SetCurcyCode(g);this.SetExchDate(h);this.SetAmount(i,false)}};b.prototype.SetAmount=function(j,h){var k=SiebelApp.S_App.LocaleObject.GetCurrency(this.GetCurcyCode());var g=0;while(isNaN(j.charAt(g))){g++}j=j.substring(g);if(k){j=k.m_sSymbol+j}this.SetAmountValue(j)};b.prototype.PostChangesOnBlur=function(){this.GetNewValues();if(!(this.isValuesChanged())){return}var g=CCFMiscUtil_CreatePropSet();g=this.SetDefaultParams();g=this.SetValueParams(g);var h=CCFMiscUtil_CreatePropSet();g.SetProperty("SWEMethod","PostChanges");SiebelApp.S_App.CallServer(g,h,false)};return b}())};
/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2013 Oracle and/or its affiliates. All rights reserved.
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
if(typeof(SiebelApp.S_App.View)==="undefined"){SiebelJS.Namespace("SiebelApp.S_App.View");SiebelApp.S_App.View=(function(){var q=SiebelJS.Dependency("SiebelApp.Utils");var l=SiebelJS.Dependency("SiebelApp.Constants");var c=l.get("SWE_PST_NEW_APPLET"),m=l.get("SWE_PST_NEW_LIST_APPLET"),j=l.get("SWE_PST_NEW_CALENDARAPPLET"),s=l.get("SWE_PST_NEW_PLAYBARAPPLET"),d=l.get("SWE_PST_QTP_INFO"),n=l.get("SWE_PST_ACTIVE_APPLET"),k=l.get("SWE_PST_APPLET_INFO"),g=l.get("SWE_PST_ACCESSIBILITY_INFO"),i=l.get("SWE_PST_NEW_TREEAPPLET");function o(){var u={};var v=null;var w=null;var t=null;this.GetAppletMap=function(){return u};this.SetActiveAppletOnLoad=function(x){v=x};this.GetActiveAppletOnLoad=function(){return v};this.SetActiveAppletInternal=function(x){w=x};this.GetActiveApplet=function(){return w};this.SetActiveAppletBeforePopup=function(x){t=x};this.GetActiveAppletBeforePopup=function(){return t};SiebelApp.S_App.ErrorObject.DecorateErrorCapability(this)}o.prototype.GetPropArray=function(){return["GetAppletMap","GetName","GetTitle"]};o.prototype.GetMethodArray=function(){return[]};o.prototype.EndLife=function(){var u=this.GetAppletMap();for(var v in u){if(u.hasOwnProperty(v)){if(u[v]&&u[v].EndLife){u[v].EndLife()}delete u[v]}}u=null;this.SetActiveAppletInternal(null);this.SetActiveAppletOnLoad(null);this.SetActiveAppletBeforePopup(null);var t=SiebelAppFacade.ComponentMgr.FindComponent({id:this.GetName()});if(t){var x=t.GetPR();if(x&&x.EndLife){x.EndLife()}var w=t.GetPM();if(w&&w.EndLife){w.EndLife()}}SiebelAppFacade.ComponentMgr.DeRegisterLevel(this);SiebelApp.S_App.ErrorObject.DeleteErrorObj(this)};function r(t){this.GetAppletMap()[t.GetName()]=t}o.prototype.GetApplet=function(t){return this.GetAppletMap()[t]||null};o.prototype.GetAppletById=function(w){var t=this.GetAppletMap(),v=null;for(var u in t){if(t.hasOwnProperty(u)){if(t[u].GetVarName()==w){v=t[u];break}}}return v};o.prototype.RemoveApplet=function(t){if(this.GetActiveApplet()===t){this.SetActiveAppletInternal(null)}if(this.GetActiveAppletOnLoad()===t){this.SetActiveAppletOnLoad(null)}var u=this.GetAppletMap()[t.GetName()];if(u){var v=SiebelAppFacade.ComponentMgr.FindComponent({id:u.GetName()});if(v){SiebelAppFacade.ComponentMgr.DeleteComponent(v,this)}if(u.EndLife){u.EndLife()}u=null;delete this.GetAppletMap()[t.GetName()];this.ClearErrorMsg();return true}this.SetErrorMsg("AppErrNoSuchApplet");return false};o.prototype.DeletePopup=function(){var z=false;var y=[];var C=this.GetAppletMap();for(var t in C){if(C.hasOwnProperty(t)){var u=C[t];if(u.GetPopupApplet()){var A=u.GetPopupApplet();y.push(A);if(A.GetPopupApplet()){while(A&&A.GetPopupApplet()){var v=A.GetPopupApplet();y.push(v);A=v}}var w=y.length;for(var x=w-1;x>=0;x--){var B=y[x];B.GetParentApplet().DeletePopup();this.SetActiveAppletBeforePopup(null);z=true}}}}if(!z){b.call(this,this.GetActiveAppletBeforePopup());this.SetActiveAppletBeforePopup(null)}};function b(t){if(t){this.SetActiveAppletInternal(t);t.SetAppletActive(true,t);t.SetFocusDefaultControl(true);t.FocusDefaultControl()}}function h(t){var u=this.GetApplet(t);if(u){u.Initialize();SiebelAppFacade.ComponentMgr.FindComponent({id:t}).Show();u.ShowOnly();u.ShowSelection();if(u.HasCustomShadow()&&u.shadow&&typeof(u.shadow.OnLoad)==="function"){u.shadow.OnLoad()}}b.call(this,this.GetActiveAppletOnLoad())}o.prototype.Initialize=function(){var v=null;var u=this.GetAppletMap();for(v in u){if(u.hasOwnProperty(v)){u[v].Initialize()}}SiebelApp.S_App.NotifyTimer("TimeGoToView",[this.GetName(),"Objects Initialized"]);var t=SiebelAppFacade.ComponentMgr.FindComponent({id:this.GetName()});SiebelAppFacade.ComponentMgr.Show(this);if(t){t.Show()}u=this.GetAppletMap();for(v in u){if(u.hasOwnProperty(v)){u[v].ShowOnly()}}SiebelApp.S_App.NotifyTimer("TimeGoToView",[this.GetName(),"Finished Populate"]);u=this.GetAppletMap();for(v in u){if(u.hasOwnProperty(v)){u[v].ShowSelection();this.ClearErrorMsg();if(u[v].HasCustomShadow()&&u[v].shadow&&typeof(u[v].shadow.OnLoad)==="function"){u[v].shadow.OnLoad()}}}SiebelApp.S_App.NavCtrlMgr.Show(false);b.call(this,this.GetActiveAppletOnLoad());SiebelApp.S_App.GetCmdMgr().UpdateUIControls()};o.prototype.ExecuteFrame=function(v,u){var t=SiebelApp.S_App.GetRequestDefault();var z=CCFMiscUtil_CreatePropSet();var x=this.GetApplet(v);var w=0;t.SetProperty(l.get("SWE_CMD_ARG"),l.get("SWE_CMD_INVOKE_METHOD_STR"));t.SetProperty(l.get("SWE_METHOD_STR"),"ExecuteFrameQuery");t.SetProperty(l.get("SWE_APPLET_STR"),v);t.SetProperty(l.get("SWE_VIEW_ARG"),this.GetName());for(w=0;w<u.length;w++){var y=x.GetControl(u[w].field);t.SetProperty(y.GetInputName(),u[w].value)}SiebelApp.S_App.CallServer(t,z,true,{async:false,cb:function(){},scope:this})};function a(v){var u;var t=SiebelApp.S_App.GetRequestDefault();t.SetProperty(l.get("SWE_APPLET_STR"),v);t.SetProperty(l.get("SWE_CMD_ARG"),l.get("SWE_GET_APPLET_LAYOUT"));u=q.EncodeToQueryString(t);return SiebelApp.S_App.GetPageURL()+l.get("SWE_ARG_START")+u}o.prototype.HandleRefreshLayout=function(w){var t=w.GetChildByType("api");var y;if(!q.IsEmpty(t)){var x=t.GetChildByType("vi");var v=x.EnumChildren(true);do{var u=v.GetType();switch(u){case c:case m:case i:y=v.GetChild(0);p.call(this,y);break;case k:p.call(this,v);break}}while((v=x.EnumChildren(false)))}};function p(z){var x=false;x=q.IsTrue(z.GetProperty(l.get("SWE_PROP_IS_PARTIAL")));if(x){var u;var y;var v;u=z.GetProperty(l.get("SWE_PROP_NAME"));y=z.GetProperty(l.get("SWE_PROP_TOGGLE_VAR_NAME"));v=z.GetProperty(l.get("SWE_PROP_VAR_NAME"));if(q.IsEmpty(v)){v=z.GetValue();u=this.GetAppletById(v).GetName()}var t=a(u);if(!q.IsEmpty(y)){SiebelApp.S_App.uiStatus.Busy({target:$("#"+y),mask:true});$("#"+y).attr("id",v).attr("src",t)}else{SiebelApp.S_App.uiStatus.Busy({target:$("#"+v),mask:true});$("#"+v).attr("src",t)}if(!q.IsEmpty(t)&&!q.IsEmpty(y)){f.call(this,this.GetAppletById(y))}var w=this;SiebelApp.contentUpdater.AddCallBack(t,function(){h.call(w,u);SiebelJS.Log("Loaded applet:"+u);SiebelApp.S_App.uiStatus.Free()},this);SiebelApp.contentUpdater.loadContent()}}function f(t){var u=t.GetBusComp();this.RemoveApplet(t);if(u.GetNotifyObject().GetAppletRegistry().length===1){u.EndLife();this.GetBusObj().RemoveBusComp(u)}else{u.GetNotifyObject().DeRegister(t)}}o.prototype.GetFilesAndProcessObjectInfo=function(u){var t=new $.Deferred();var v=q.PrepareModuleInfo(u);var w=this;require(v,function(){try{w.BuildFrame(u)}catch(x){SiebelJS.Log(x)}w=u=null;t.resolveWith(w,["View Process Object"])});v=null;return t.promise()};o.prototype.BuildFrame=function(t){this.ProcessObjectInfo(t)};o.prototype.ProcessObjectInfo=function(J){if(J.GetType()!=l.get("SWE_PST_VIEW_INFO")){SiebelJS.Log("[View-ProcessObjectInfo] -> Invalid PropertySet Information.");return}this.m_busObj=SiebelApp.S_App.GetActiveBusObj();SiebelApp.S_App.GetActiveBusObj().SetView(this);var D=q.Curry(SiebelApp.S_App.constructor.prototype.DefineAccessor,this,J);if(J.PropertyExists(l.get("SWE_PROP_NAME"))){D("GetName","SWE_PROP_NAME")}D("GetTitle","SWE_PROP_TITLE");D("GetPageURL","SWE_PROP_PAGEURL");
D("IsCacheable","SWE_PROP_IS_CACHEABLE");D("GetThreadBarHTML","SWE_PROP_THREAD_BAR");D("GetViewType","SWE_PROP_VIEW_TYPE");D("IsCacheable","SWE_PROP_IS_CACHEABLE");D("GetInvokeMethod","SWE_PROP_VIEW_INVOKECOMMAND");D("GetTaskViewTitle","SWE_PROP_VIEW_TASKVIEWTITLE");D("GetTaskStepTitle","SWE_PROP_VIEW_TASKSTEPTITLE");D("GetActiveTask","SWE_PROP_VIEW_ACTIVETASK");D("GetDisableCancelPDQ","SWE_PROP_DISABLE_CANCEL_PDQ");if(!SiebelAppFacade.ComponentMgr.FindComponent({id:this.GetName()})){if(!J.GetProperty(l.get("SWE_UIDEF_PM_CTR"))){J.SetPropertyStr(l.get("SWE_UIDEF_PM_CTR"),"siebel/viewpm")}if(!J.GetProperty(l.get("SWE_UIDEF_PR_CTR"))){J.SetPropertyStr(l.get("SWE_UIDEF_PR_CTR"),"siebel/viewpr")}SiebelAppFacade.ComponentMgr.MakeComponent(SiebelApp.S_App,J,this)}e.call(this);var w=J.EnumChildren(true),A=SiebelAppFacade.ProxyFactory,u=SiebelAppFacade.ComponentMgr,v=null,E=null,t=null;while(w){t=w.GetType();switch(t){case k:var F=w.GetValue();if(!q.IsEmpty(F)){v=this.GetAppletById(F);v.ProcessObjectInfo(w,false);if(v.GetName()!=="Persistent Customer Dashboard Applet"){var B=u.FindComponent(v.GetName());if(B){B.SwitchPMnPR(w,v)}}r.call(this,v)}break;case g:var L=q.Curry(SiebelApp.S_App.constructor.prototype.DefineAccessor,this,w);L("GetViewSummary","SWE_PROP_VIEW_SUMMARY");if(this.GetViewSummary()===undefined){this.GetViewSummary=this.GetTitle}break;case d:var y=q.Curry(SiebelApp.S_App.constructor.prototype.DefineAccessor,this,w);y("GetObjectType","SWE_PROP_QTP_OT");y("GetRepstrName","SWE_PROP_QTP_RN");y("GetUIName","SWE_PROP_QTP_UN");break;case n:E=w;break;default:v=A.MakeObject(t);if(v){v.SetView(this);v.ProcessObjectInfo(w.GetChild(0));r.call(this,v);u.MakeComponent(this,w.GetChild(0),v)}break}w=J.EnumChildren(false)}if(E!==null){var G=E.GetProperty(l.get("SWE_PROP_NAME"));var K=this.GetApplet(G);this.SetActiveAppletOnLoad(K);var C=SiebelApp.S_App.GetPopupPM();if(C.Get("state")===l.get("POPUP_STATE_VISIBLE")&&K){var I=0;var x=C.Get("currPopups");var z=x.length;var H=false;for(I=0;I<z;I++){if(x[I].GetName()===K.GetName()){H=true;break}}if(!H){C.Get("currPopups").push(this.GetApplet(G))}}}J=E=null};o.prototype.GetThreadBarPlaceHolder=function(){return l.get("SWE_THREADBAR_IDENTIFIER")};function e(){$("#"+this.GetThreadBarPlaceHolder()).html(this.GetThreadBarHTML()).addClass(SiebelApp.S_App.GetDirection()?" siebui-rtl-element-right":"")}o.prototype.GetBusObj=function(){return this.m_busObj};o.prototype.ExecuteUIUpdate=function(){var t=this.GetAppletMap();for(var u in t){if(t.hasOwnProperty(u)){t[u].ExecuteUIUpdate()}}};o.prototype.SetActiveApplet=function(t){if(t&&this.IsAppletActive(t)){return true}var u=this.GetActiveApplet();if(!u){u=SiebelApp.S_App.GetExternalActiveApplet()}if(u){if(!u.SetAppletActive(false,t)){return false}}this.SetActiveAppletInternal(t);if(t&&!this.GetActiveApplet().SetAppletActive(true,t)){return false}if(u&&u!==t){u.ResetAppletState()}SiebelApp.S_App.GetCmdMgr().UpdateUIControls();this.ClearErrorMsg();return true};o.prototype.IsAppletActive=function(t){return(this.GetActiveApplet()===t)};o.prototype.SetActiveAppletByName=function(v,u){var t=this.GetApplet(v);return this.SetActiveApplet(t)};o.prototype.GotoSelectedTreeNode=function(){var v=this.GetActiveApplet();if(v&&v.GetParentApplet()){return true}var t=this.GetAppletMap();for(var u in t){if(t.hasOwnProperty(u)){if(t[u]){t[u].FocusSelectedTreeNode()}}}};o.prototype.CycleActiveApplet=function(t){var u=true;var v=null;var z=null;var A=0;var B=[];var F;var D=this.GetActiveApplet();var w;var y;if(D&&D.GetParentApplet()){return true}var E=this.GetAppletMap();for(var C in E){if(E.hasOwnProperty(C)){B[A]=E[C];A++}}for(var x=0;x<B.length;x++){if(u){v=B[x];u=false}if(B[x]===D){F=x;break}z=B[x]}if(!v){this.SetErrorMsg("ViewErrNoApplets");return false}else{if(!D){return this.SetActiveApplet(v)}}if(t){if(!z){w=B[B.length-1]}else{w=z}}else{if(F<(B.length-1)){w=B[F+1]}else{w=B[0]}}if(!w||(D===w)){return true}y=this.SetActiveApplet(w);if(y){w.SetFocusDefaultControl(true);w.FocusDefaultControl(true)}};return o}())};
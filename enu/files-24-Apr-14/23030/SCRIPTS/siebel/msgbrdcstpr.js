/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2013 Oracle and/or its affiliates. All rights reserved.
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
if(typeof(SiebelAppFacade.MsgBrdCstPhyRenderer)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.MsgBrdCstPhyRenderer");var HTMLMessages="";var HTMLMsgCount="";var isMsgChanged=false;var m_strNormal="";var m_strAuto="";var m_strHigh="";var m_strUrgent="";var m_strUrgentWA="";var m_normalColor="";var m_highColor="";var m_urgentColor="";var m_updateInterval=120;var m_prefixNormal="";var m_prefixHigh="";var m_prefixUrgent="";var msgArray=[];var consts=SiebelJS.Dependency("SiebelApp.Constants");var utils=SiebelJS.Dependency("SiebelApp.Utils");var myDlg;var isMsgDeleteEvent=false;var objPM="";var m_blinkFlg=false;var m_strRdLtstClrCode="siebui-msgbarbkgrnd-msgread-nomsgs";var m_strUnRdLtstClrCode="";var m_blinktimer="";var m_strNtfcSummaryText="";var m_strNtfcDetailsText="";var m_strCloseText="";var m_dWidth="";var m_dPosY="";var m_strNotification="";var m_selectedrowId="";var m_msgexpired="";var m_isUnrdUwA=false;var m_strMsgRowClass;SiebelAppFacade.MsgBrdCstPhyRenderer=(function(){function d(g){var f=g;this.GetPM=function(){return f}}d.prototype.ShowUI=function(){var g=this.GetPM();var h=document.getElementById("HTMLMessageBar");if(h){g.OnControlEvent("ShowMessageBar")}objPM=g;var f=SiebelApp.S_App.LocaleObject;m_strNtfcSummaryText=f.GetLocalString("IDS_MSG_NOTIFICATION_SUMMARY");m_strNtfcDetailsText=f.GetLocalString("IDS_MSG_NOTIFICATION_DETAILS");m_strCloseText=f.GetLocalString("IDS_MSG_CLOSE");m_strNotification=f.GetLocalString("IDS_MSG_NOTIFICATION");m_msgexpired=f.GetLocalString("IDS_MSG_EXPIRED");if(m_strNtfcSummaryText===undefined||m_strNtfcSummaryText===""){m_strNtfcSummaryText="Notification Summary"}if(m_strNtfcDetailsText===undefined||m_strNtfcDetailsText===""){m_strNtfcDetailsText="Notification Details"}if(m_strCloseText===undefined||m_strCloseText===""){m_strCloseText="Close"}if(m_strNotification===undefined||m_strNotification===""){m_strNotification="Notification"}if(m_msgexpired===undefined||m_msgexpired===""){m_msgexpired="Message Expired"}};d.prototype.CreateMsgBar=function(){msgArray=objPM.Get("MsgObjArray");var i=objPM.Get("MsgChanged");var f=objPM.Get("MsgUserPrefPS");m_strNormal=f.GetProperty("Normal");m_strAuto=f.GetProperty("Automation");m_strHigh=f.GetProperty("High");m_strUrgent=f.GetProperty("Urgent");m_strUrgentWA=f.GetProperty("UrgentWA");m_normalColor=f.GetProperty("NormalColor");m_highColor=f.GetProperty("HighColor");m_urgentColor=f.GetProperty("UrgentColor");m_updateInterval=f.GetProperty("UpdateInterval");m_prefixNormal=f.GetProperty("PrefixNormal");m_prefixHigh=f.GetProperty("PrefixHigh");m_prefixUrgent=f.GetProperty("PrefixUrgent");if(i){c()}if(SiebelApp.S_App.IsMobileApplication()==="true"){$("div[id='HTMLMessageBar']").append('<a id="MsgBar" class="siebui-mobile-msgbar" title="'+m_strNotification+'"><h5>'+HTMLMsgCount+"</h5></a>").trigger("create");if(m_strAuto.toString()==="TRUE"){$("div[id='HTMLMessageBar']").attr("ot","MsgBrdCstIcon");$("div[id='HTMLMessageBar']").attr("rn","MsgBrdCstIcon");$("div[id='HTMLMessageBar']").attr("un","Notification")}}else{$("div[id='HTMLMessageBar']").append('<a id="MsgBar" href="javascript:void(0)" class="siebui-msgbar" aria-label="'+HTMLMsgCount+' Unread Notification"  title="'+m_strNotification+'">'+HTMLMsgCount+"</a>").trigger("create");if(m_strAuto.toString()==="TRUE"){$("div[id='HTMLMessageBar']").attr("ot","MsgBrdCstIcon");$("div[id='HTMLMessageBar']").attr("rn","MsgBrdCstIcon");$("div[id='HTMLMessageBar']").attr("un","Notification")}}if(m_blinkFlg){this.blink(2000);m_blinkFlg=false}if(m_strUnRdLtstClrCode!==""){if(SiebelApp.S_App.IsMobileApplication()==="true"){$("#MsgBar h5").addClass(m_strUnRdLtstClrCode)}else{$("#MsgBar").addClass(m_strUnRdLtstClrCode)}}else{if(SiebelApp.S_App.IsMobileApplication()==="true"){$("#MsgBar h5").addClass(m_strRdLtstClrCode)}else{$("#MsgBar").addClass(m_strRdLtstClrCode)}}if(SiebelApp.S_App.IsMobileApplication()!=="true"){var h=$("#MsgBar").attr("aria-label");var g=a();h=h+" Priority :"+g;$("#MsgBar").attr("aria-label",h)}};function c(){var l=0;var k=0;var n;var o;m_strUnRdLtstClrCode="";m_blinkFlg=false;var m;var g;var p;var q=[];if(SiebelApp.S_App.IsMobileApplication()==="true"){HTMLMessages="<div class='siebui-mb-msg-summary-heading'>"+m_strNtfcSummaryText+"</div><div id='MsgBrdCst_Summary' class='siebui-mb-msgbrdcst-summary'><ul data-role='listview' data-split-icon='delete' data-split-theme='b'>"}else{HTMLMessages="<div id='MsgBrdCst_Summary' class='siebui-msgbrdcst-heading'><ul role='listbox' tabindex='0' data-role='listview'>"}var f=msgArray.length;HTMLMsgCount=f;for(l=0;l<f;l++){m=b(msgArray[l],true);g=msgArray[l].id;p=msgArray[l].status;n=msgArray[l].type;o=msgArray[l].dismiss;if(n===m_strUrgent.valueOf()||n===m_strUrgentWA.valueOf()){m_strMsgRowClass="siebui-msgbar-row-urgent"}else{if(n===m_strHigh.valueOf()){m_strMsgRowClass="siebui-msgbar-row-high"}else{if(n===m_strNormal.valueOf()){m_strMsgRowClass="siebui-msgbar-row-normal"}else{m_strMsgRowClass="undefined"}}}if(m_strMsgRowClass==="undefined"){HTMLMsgCount--}else{if(p==="1"){HTMLMsgCount--;q[k]=msgArray[l];k++}else{if(p==="2"){HTMLMsgCount--}else{if(p==="9"){HTMLMessages+="<li id='"+g+"' class='"+m_strMsgRowClass+"' data-status='"+p+"'>"+m+"</li>"}else{if(SiebelApp.S_App.IsMobileApplication()==="true"){HTMLMessages+="<li id='"+g+"' class='unreadmessage "+m_strMsgRowClass+"' data-icon='false' data-status='"+p+"'><a>"+m;if(o==="Y"){HTMLMessages+="</a><button id='DeleteMsgBtnId' class='siebui-mb-deletemsgbtn' data-role='button' data-inline='true'></button></li>"}else{HTMLMessages+="</li>"}}else{HTMLMessages+="<li id='"+g+"' role='presentation' class='unreadmessage "+m_strMsgRowClass+"' data-status='"+p+"'>"+m;if(o==="Y"){HTMLMessages+="<div><div><a id='DeleteMsgBtnIdNonMobile' aria-label='Delete Notification' tabindex='0' class='siebui-deletemsgbtn ui-state-default ui-corner-all' role='button' href='javascript:void(0)'><span class='ui-icon ui-icon-circle-close'></span></a></div></div></li>"}else{HTMLMessages+="</li>"}}if(n===m_strUrgent.valueOf()||n===m_strUrgentWA.valueOf()){if(n===m_strUrgentWA.valueOf()){m_blinkFlg=true;m_isUnrdUwA=true}m_strUnRdLtstClrCode="siebui-msgbar-bkgrnd-msg-urgent"}else{if(n===m_strHigh.valueOf()&&(m_strUnRdLtstClrCode!=="siebui-msgbar-bkgrnd-msg-urgent")){m_strUnRdLtstClrCode="siebui-msgbar-bkgrnd-msg-high"}else{if(n===m_strNormal.valueOf()&&((m_strUnRdLtstClrCode!=="siebui-msgbar-bkgrnd-msg-urgent")&&(m_strUnRdLtstClrCode!=="siebui-msgbar-bkgrnd-msg-high"))){m_strUnRdLtstClrCode="siebui-msgbar-bkgrnd-msg-normal"}}}}}}}}var h=q.length;for(l=0;l<h;l++){m=b(q[l],true);g=q[l].id;o=q[l].dismiss;p=q[l].status;n=q[l].type;if(n===m_strUrgent.valueOf()||n===m_strUrgentWA.valueOf()){m_strMsgRowClass="siebui-msgbar-row-urgent"}else{if(n===m_strHigh.valueOf()){m_strMsgRowClass="siebui-msgbar-row-high"}else{if(n===m_strNormal.valueOf()){m_strMsgRowClass="siebui-msgbar-row-normal"}}}if(SiebelApp.S_App.IsMobileApplication()==="true"){HTMLMessages+="<li id='"+g+"' class='readmessage "+m_strMsgRowClass+"' data-icon='false' data-status='"+p+"'><a>"+m;
if(o==="Y"){HTMLMessages+="</a><button id='DeleteMsgBtnId' class='siebui-mb-deletemsgbtn' data-role='button' data-inline='true'></button></li>"}else{HTMLMessages+="</li>"}}else{HTMLMessages+="<li id='"+g+"' role='presentation' class='readmessage "+m_strMsgRowClass+"' data-status='"+p+"'>"+m;if(o==="Y"){HTMLMessages+="<div><div><a id='DeleteMsgBtnIdNonMobile' aria-label='Delete Notification' tabindex='0' class='siebui-deletemsgbtn ui-state-default ui-corner-all' role='button' href='javascript:void(0)'><span class='ui-icon ui-icon-circle-close'></span></a></div></div></li>"}else{HTMLMessages+="</li>"}}}if(SiebelApp.S_App.IsMobileApplication()==="true"){HTMLMessages+="</ul></div>"}else{HTMLMessages+="</ul></div>"}}function e(v,n){var s;var u=[];var o=0;var k=0;HTMLMessages="";m_blinkFlg=false;var p;var q;var h;m_strUnRdLtstClrCode="";var g;var m;if(SiebelApp.S_App.IsMobileApplication()==="true"){HTMLMessages="<div class='siebui-mb-msg-summary-heading'>"+m_strNtfcSummaryText+"</div><div id='MsgBrdCst_Summary' class='siebui-mb-msgbrdcst-summary'><ul data-role='listview' data-split-icon='delete' data-split-theme='b'>"}else{HTMLMessages="<div id='MsgBrdCst_Summary' class='siebui-msgbrdcst-heading'><ul role='listbox' tabindex='0' data-role='listview'>"}var f=msgArray.length;HTMLMsgCount=f;for(o=0;o<f;o++){m=b(msgArray[o],true);g=msgArray[o].id;p=msgArray[o].type;q=msgArray[o].dismiss;p=msgArray[o].type;if(p===m_strUrgent.valueOf()||p===m_strUrgentWA.valueOf()){m_strMsgRowClass="siebui-msgbar-row-urgent"}else{if(p===m_strHigh.valueOf()){m_strMsgRowClass="siebui-msgbar-row-high"}else{if(p===m_strNormal.valueOf()){m_strMsgRowClass="siebui-msgbar-row-normal"}else{m_strMsgRowClass="undefined"}}}if(g===n){msgArray[o].status=v;s=v}else{s=msgArray[o].status}if(m_strMsgRowClass==="undefined"){HTMLMsgCount--}else{if(s==="1"){HTMLMsgCount--;u[k]=msgArray[o];k++}else{if(s==="2"){HTMLMsgCount--}else{if(s==="9"){HTMLMessages+="<li id='"+g+"' data-status='"+s+"'>"+m+"</li>"}else{if(SiebelApp.S_App.IsMobileApplication()==="true"){HTMLMessages+="<li id='"+g+"' class='unreadmessage "+m_strMsgRowClass+"' data-icon='false' data-status='"+s+"'><a>"+m;if(q==="Y"){HTMLMessages+="</a><button id='DeleteMsgBtnId' class='siebui-mb-deletemsgbtn' data-role='button' data-inline='true'></button></li>"}else{HTMLMessages+="</li>"}}else{HTMLMessages+="<li id='"+g+"' role='presentation' class='unreadmessage "+m_strMsgRowClass+"' data-status='"+s+"'>"+m;if(q==="Y"){HTMLMessages+="<div><div><a id='DeleteMsgBtnIdNonMobile' aria-label='Delete Notification' tabindex='0' class='siebui-deletemsgbtn ui-state-default ui-corner-all' role='button' href='javascript:void(0)'><span class='ui-icon ui-icon-circle-close'></span></a></div></div></li>"}else{HTMLMessages+="</li>"}}if(p===m_strUrgent.valueOf()||p===m_strUrgentWA.valueOf()){if(p===m_strUrgentWA.valueOf()){m_blinkFlg=true;m_isUnrdUwA=true}m_strUnRdLtstClrCode="siebui-msgbar-bkgrnd-msg-urgent"}else{if(p===m_strHigh.valueOf()&&(m_strUnRdLtstClrCode!=="siebui-msgbar-bkgrnd-msg-urgent")){m_strUnRdLtstClrCode="siebui-msgbar-bkgrnd-msg-high"}else{if(p===m_strNormal.valueOf()&&((m_strUnRdLtstClrCode!=="siebui-msgbar-bkgrnd-msg-urgent")&&(m_strUnRdLtstClrCode!=="siebui-msgbar-bkgrnd-msg-high"))){m_strUnRdLtstClrCode="siebui-msgbar-bkgrnd-msg-normal"}}}}}}}}h=u.length;for(o=0;o<h;o++){m=b(u[o],true);g=u[o].id;q=u[o].dismiss;s=u[o].status;p=u[o].type;if(p===m_strUrgent.valueOf()||p===m_strUrgentWA.valueOf()){m_strMsgRowClass="siebui-msgbar-row-urgent"}else{if(p===m_strHigh.valueOf()){m_strMsgRowClass="siebui-msgbar-row-high"}else{if(p===m_strNormal.valueOf()){m_strMsgRowClass="siebui-msgbar-row-normal"}}}if(SiebelApp.S_App.IsMobileApplication()==="true"){HTMLMessages+="<li id='"+g+"' class='readmessage "+m_strMsgRowClass+"' data-icon='false' data-status='"+s+"'><a>"+m;if(q==="Y"){HTMLMessages+="</a><button id='DeleteMsgBtnId' class='siebui-mb-deletemsgbtn' data-role='button' data-inline='true'></button></li>"}else{HTMLMessages+="</li>"}}else{HTMLMessages+="<li id='"+g+"' role='presentation' class='readmessage "+m_strMsgRowClass+"' data-status='"+s+"'>"+m;if(q==="Y"){HTMLMessages+="<div><div><a id='DeleteMsgBtnIdNonMobile' aria-label='Delete Notification' tabindex='0' class='siebui-deletemsgbtn ui-state-default ui-corner-all' role='button' href='javascript:void(0)'><span class='ui-icon ui-icon-circle-close'></span></a></div></div></li>"}else{HTMLMessages+="</li>"}}}if(SiebelApp.S_App.IsMobileApplication()==="true"){HTMLMessages+="</ul></div>"}else{HTMLMessages+="</ul></div>"}var t=document.getElementById("MsgBar");if(SiebelApp.S_App.IsMobileApplication()==="true"){t.innerHTML="<h5>"+HTMLMsgCount+"</h5>"}else{t.innerText=HTMLMsgCount}if(m_strUnRdLtstClrCode!==""){if(SiebelApp.S_App.IsMobileApplication()==="true"){$("#MsgBar h5").addClass(m_strUnRdLtstClrCode)}else{$("#MsgBar").addClass(m_strUnRdLtstClrCode)}}else{if(SiebelApp.S_App.IsMobileApplication()==="true"){$("#MsgBar h5").addClass(m_strRdLtstClrCode)}else{$("#MsgBar").addClass(m_strRdLtstClrCode)}}if(!m_blinkFlg){window.clearInterval(m_blinktimer);m_blinkFlg=false}objPM.OnControlEvent("UpdateServer",n,v);if(SiebelApp.S_App.IsMobileApplication()!=="true"){var r=$("#MsgBar").attr("aria-label");var l=a();r=r+" Priority :"+l;$("#MsgBar").attr("aria-label",r)}}d.prototype.blink=function(f){if(SiebelApp.S_App.IsMobileApplication()==="true"){m_blinktimer=window.setInterval(function(){$("#MsgBar h5").addClass("msgblinkstylemobi");window.setTimeout(function(){$("#MsgBar h5").removeClass("msgblinkstylemobi")},1000)},f)}else{m_blinktimer=window.setInterval(function(){$("#MsgBar").addClass("msgblinkstyle");window.setTimeout(function(){$("#MsgBar").removeClass("msgblinkstyle")},1000)},f)}};d.prototype.BindEvents=function(){var f=this;$(document).delegate("#DeleteMsgBtnId","click",function(){var h=$(this).parent().attr("data-status");if(h!=="9"){isMsgDeleteEvent=true;var g=$(this).parent().attr("id");e("2",g);$(this).parent().addClass("deletemessage");if($("[name=popupChild]").length>0){$("[name=popupChild]").popup("close");$("[name=popupChild]").remove()}}});$(document).delegate("#DeleteMsgBtnIdNonMobile span.ui-icon-circle-close","click",function(){var h=$(this).closest("li").attr("data-status");if(h!=="9"){isMsgDeleteEvent=true;var g=$(this).closest("li").attr("id");e("2",g);$(this).closest("li").addClass("deletemessage")}});$(document).delegate(".ui-widget-overlay","click",function(){if($("#dialog_content").length>0){$("#dialog_content").remove()}if($("#Msg_Summary").length>0){$("#Msg_Summary").remove()}});$(document).delegate(".ui-overlay-a","click",function(){if($("[name=popupChild]").length>0){$("[name=popupChild]").popup("close");$("[name=popupChild]").remove()}});$(document).delegate("#CloseChild","click",function(){if($("[name=popupChild]").length>0){$("[name=popupChild]").popup("close");$("[name=popupChild]").remove()}});$(document).delegate("#CloseDialog","click",function(){if($("[name=popupParent]").length>0){$("[name=popupParent]").popup("close");
$("[name=popupParent]").remove()}if($("[name=popupChild]").length>0){$("[name=popupChild]").popup("close");$("[name=popupChild]").remove()}});$("#HTMLMessageBar").delegate(" a","click",function(){if(SiebelApp.S_App.IsMobileApplication()==="true"){if($("[name=popupParent]").length>0){$("[name=popupParent]").remove()}var h=$('<div name="popupParent" id="popupParent" data-rel="popup" data-theme="e" data-overlay-theme="a" class="ui-content popupParent">'+HTMLMessages+"</div>");SiebelApp.S_App.GetTargetViewContainer().append(h);$("[name=popupParent]").popup();$("[name=popupParent]").popup("open");$(".popupContainer").trigger("create");$("[name=popupParent]").popup({afterclose:function(o,p){if($("[name=popupChild]").length>0){$("[name=popupChild]").popup("close");$("[name=popupChild]").remove()}}});var i=window.innerHeight>window.innerWidth?"portrait":"landscape";var m=$("[name=popupParent]").parent();$(m).addClass("siebui-msgbar-popup");var g=$(".ui-popup-container");m_dWidth=g.outerWidth();m_dPosY=g[0].offsetTop;$("[name=ParentClose]").bind("click",function(o){if($("[name=popup]").length>0){$("[name=popup]").popup("close")}});var j=navigator.userAgent.match(/(iPhone)|(iPod)|(Android.*Mobile)/i);if(j){$(".siebui-mb-msgbrdcst-summary").parent().addClass("siebui-MsgBrdCst-Heading-phone")}if(m_strAuto.toString()==="TRUE"){$("div[id='MsgBrdCst_Summary']").attr("ot","MsgBrdCstSummary");$("div[id='MsgBrdCst_Summary']").attr("rn","MsgBrdCstSummary");$("div[id='MsgBrdCst_Summary']").attr("un","Notification Summary")}}else{var l=navigator.userAgent.toString().toLowerCase();var n=(l.indexOf("msie")!==-1);var k;if(n){k=$('<div id="Msg_Summary"></div>').html(HTMLMessages).dialog({title:m_strNtfcSummaryText,position:["right",40],autoOpen:false,width:500,draggable:false,minHeight:100,modal:true,resizable:false,open:function(o,p){$(this).parent().find("div.ui-dialog-titlebar").addClass("titleClass")},beforeClose:function(o,p){if($("#dialog_content").length>0){$("#dialog_content").remove()}if($("#Msg_Summary").length>0){$("#Msg_Summary").remove()}}})}else{k=$('<div id="Msg_Summary"></div>').html(HTMLMessages).dialog({title:m_strNtfcSummaryText,position:["right",40],autoOpen:false,draggable:false,width:500,minHeight:100,modal:true,resizable:false,show:{effect:"drop",direction:"up",duration:1000},hide:{effect:"drop",direction:"up",duration:1000},open:function(o,p){$(this).find("span").first().focus();$(this).parent().find("div.ui-dialog-titlebar").addClass("titleClass")},beforeClose:function(o,p){if($("#dialog_content").length>0){$("#dialog_content").remove()}if($("#Msg_Summary").length>0){$("#Msg_Summary").remove()}}})}if(m_strAuto.toString()==="TRUE"){$("div[id='Msg_Summary']").attr("ot","MsgBrdCstSummary");$("div[id='Msg_Summary']").attr("rn","MsgBrdCstSummary");$("div[id='Msg_Summary']").attr("un","Notification Summary")}k.dialog("open")}});$(document).delegate("#MsgBrdCst_Summary li","keydown",function(g){if(SiebelApp.S_App.IsMobileApplication()!=="true"){var h=(g.keyCode)?g.keyCode:g.charCode;var i=$(this)[0];switch(h){case 38:$(i).prev().find("span").first().focus();g.preventDefault();break;case 40:$(i).next().find("span").first().focus();g.preventDefault();break;case 13:$(this).trigger("click");g.preventDefault();break}}});$(document).delegate("#MsgBrdCst_Summary li","click",function(z){var x=0;var h;var p,q;if($("#dialog_content").length>0){$("#dialog_content").remove()}var D=f.GetPM().Get("MsgUserPrefPS");m_strNormal=D.GetProperty("Normal");m_strHigh=D.GetProperty("High");m_strUrgent=D.GetProperty("Urgent");m_strUrgentWA=D.GetProperty("UrgentWA");m_normalColor=D.GetProperty("NormalColor");m_highColor=D.GetProperty("HighColor");m_urgentColor=D.GetProperty("UrgentColor");m_updateInterval=D.GetProperty("UpdateInterval");m_prefixNormal=D.GetProperty("PrefixNormal");m_prefixHigh=D.GetProperty("PrefixHigh");m_prefixUrgent=D.GetProperty("PrefixUrgent");var u;var w;var A;var y;var t;var o;if(!isMsgDeleteEvent){y=$(this)[0].innerText;t=$(this)[0].id;o=$(this).attr("data-status");if(o!=="9"){$(this).addClass("readmessage")}var m=msgArray.length;for(x=0;x<m;x++){var g=msgArray[x];if(g.id===t){A=g.body;u=g.type;w=g.summary;break}}if(u===m_strUrgent.valueOf()||u===m_strUrgentWA.valueOf()){m_strMsgRowClass="siebui-msgbar-row-urgent"}else{if(u===m_strHigh.valueOf()){m_strMsgRowClass="siebui-msgbar-row-high"}else{if(u===m_strNormal.valueOf()){m_strMsgRowClass="siebui-msgbar-row-normal"}}}var B=w.match(/\[D\]/);if(B===null){var l=b(msgArray[x],false);if(SiebelApp.S_App.IsMobileApplication()==="true"){var j="";var n=70+parseInt(m_dWidth,10);j=n+"px";p=this.offsetTop+parseInt(m_dPosY,10);var r=navigator.userAgent.match(/(iPhone)|(iPod)|(Android.*Mobile)/i);if(r){n=$(this).parents(".ui-popup-container:first")[0].offsetLeft+0.05*parseInt(m_dWidth,10);j=n+"px";p=0.45*$(this).parents(".ui-popup-container:first")[0].offsetHeight+parseInt(m_dPosY,10)}if($("[name=popupChild]").length>0){$("[name=popupChild]").remove()}if($("[name=popup]").length===0){h=$('<div name="popup" id="MsgBrdCst_Details" class="siebui-mobile-msgbrdcst_details"><ul data-role="listview"><li class="'+m_strMsgRowClass+'">'+l+'</li></ul><a id="CloseDialog" class="siebui-mobile-msgclosedialog" rel="close" data-role="button">'+m_strCloseText+"</a></div>")}var k=window.innerHeight>window.innerWidth?"portrait":"landscape";r=navigator.userAgent.match(/(iPhone)|(iPod)|(Android.*Mobile)/i);if(r){p=z.clientY-10}else{if(k==="landscape"){p=this.offsetTop+140}else{p=z.clientY-10}}q=$(this).parents(".ui-popup-container:first")[0].offsetLeft+$(this).parents(".ui-popup-container:first")[0].offsetWidth;h=$('<div name="popupChild" id="MsgBrdCst_Details" data-role="popup" class="siebui-mobile-msgbrdcst_details"><ul data-role="listview"><li class="'+m_strMsgRowClass+'">'+l+"</li></ul></div>");SiebelApp.S_App.GetTargetViewContainer().append(h);$("[name=popupChild]").popup();$("[name=popupChild]").popup("open");$(".popupContainer").trigger("create");var s=$("[name=popupChild]").parent();$(s).removeClass().addClass("ui-popup-container ui-popup-active siebui-mb-msgbrdcst-details");$(s).css({top:p,left:q});if(m_strAuto.toString()==="TRUE"){$("div[id='MsgBrdCst_Details']").attr("ot","MsgBrdCstDetails");$("div[id='MsgBrdCst_Details']").attr("rn","MsgBrdCstDetails");$("div[id='MsgBrdCst_Details']").attr("un","Notification Details")}if(r){$(".siebui-mobile-msgbrdcst_details").parent().addClass("siebui-MsgBrdCst-Details-phone")}}else{q=$(window).width()-1002;p=z.clientY-10;var v="<div id='MsgBrdCst_Details_BigSbl' class='siebui-msgbrdcst_details "+m_strMsgRowClass+"'>"+l+"</div>";var C=$('<div id= "dialog_content"></div>').html(v).dialog({title:m_strNtfcDetailsText,position:[q,p],autoOpen:false,width:500,minHeight:100,draggable:false,modal:false,resizable:false,open:function(i,E){$(this).attr("tabindex","0");$(this).focus();$(this).parent().find("div.ui-dialog-titlebar").addClass("titleClass")},close:function(i,E){var F=$("#MsgBrdCst_Summary").find('li[id="'+t+'"]');
$(F).find("span").first().focus();if($("#dialog_content").length>0){$("#dialog_content").remove()}}});C.dialog("open");if(m_strAuto.toString()==="TRUE"){$("div[id='MsgBrdCst_Details_BigSbl']").attr("ot","MsgBrdCstDetails");$("div[id='MsgBrdCst_Details_BigSbl']").attr("rn","MsgBrdCstDetails");$("div[id='MsgBrdCst_Details_BigSbl']").attr("un","Notification Details")}}}else{objPM.OnControlEvent("DownLoadFileFromServer",A)}if(o!=="1"){if(o!=="9"){$(this).attr("data-status","1");e("1",t)}}}isMsgDeleteEvent=false;m_selectedrowId=t})};d.prototype.BindData=function(){};d.prototype.UpdateMsgBar=function(){var h=this.GetPM().Get("MsgChanged");var i=this.GetPM().Get("MsgCount");msgArray=this.GetPM().Get("MsgObjArray");if(h===true){c();if(SiebelApp.S_App.IsMobileApplication()==="true"){$("div[id='HTMLMessageBar']").children().remove();$("div[id='HTMLMessageBar']").append('<a id="MsgBar" class="siebui-mobile-msgbar" title="'+m_strNotification+'"><h5>'+HTMLMsgCount+"</h5></a>").trigger("create")}else{$("div[id='HTMLMessageBar']").children().remove();$("div[id='HTMLMessageBar']").append('<span class="ui-icon ui-icon-info"></span><a id="MsgBar" href="javascript:void(0)" class="siebui-msgbar" aria-label="'+HTMLMsgCount+' Unread Notification"  title="'+m_strNotification+'">'+HTMLMsgCount+"</a>").trigger("create")}if(m_blinkFlg){this.blink(2000);m_blinkFlg=false}else{window.clearInterval(m_blinktimer)}if(m_strUnRdLtstClrCode!==""){if(SiebelApp.S_App.IsMobileApplication()==="true"){$("#MsgBar h5").addClass(m_strUnRdLtstClrCode)}else{$("#MsgBar").addClass(m_strUnRdLtstClrCode)}}else{if(SiebelApp.S_App.IsMobileApplication()==="true"){$("#MsgBar h5").addClass(m_strRdLtstClrCode)}else{$("#MsgBar").addClass(m_strRdLtstClrCode)}}if(SiebelApp.S_App.IsMobileApplication()==="true"){if($(".siebui-mb-msgbrdcst-summary").length>0){$(".siebui-mb-msgbrdcst-summary").parent().html(HTMLMessages);$(".siebui-mb-msgbrdcst-summary").trigger("create");if($(".siebui-mobile-msgbrdcst_details").length>0){if($("#"+m_selectedrowId).length>0){$(".siebui-mobile-msgbrdcst_details").parent().remove();$("#"+m_selectedrowId).trigger("click")}else{$(".siebui-mobile-msgbrdcst_details").prepend("<span class ='siebui-mobile-msg-expired'>["+m_msgexpired+"]</span>")}}}}else{if($("#Msg_Summary").length>0){$("#Msg_Summary").html(HTMLMessages)}if($("#dialog_content").length>0){if($("#"+m_selectedrowId).length>0){$("#dialog_content").remove();$("#"+m_selectedrowId).trigger("click")}else{$("#dialog_content").prepend("<span class ='siebui-msg-expired'>["+m_msgexpired+"]</span>")}}}if(SiebelApp.S_App.IsMobileApplication()!=="true"){var g=$("#MsgBar").attr("aria-label");var f=a();g=g+" Priority :"+f;$("#MsgBar").attr("aria-label",g)}}};function b(f,t){var o;var s="siebui-msgbar-msg-normal";var h="";var u="";var q;if(t){o=f.summary;var j=f.body;var p=f.dismiss;if(f.type===m_strHigh.valueOf()){s="siebui-msgbar-msg-high"}else{if(f.type===m_strUrgent.valueOf()||f.type===m_strUrgentWA.valueOf()){s="siebui-msgbar-msg-urgent"}}o=HtmlEncode(o);if(o.indexOf("[D]")!==-1){o=o.replace(/\[D\]/g,"");u=o;if(j.indexOf("View")!==-1){q=true}if(SiebelApp.S_App.IsMobileApplication()==="false"){if(q===true){o="<span class='siebui-msgbrdcst-drilldown-icon'></span><span class='siebui-msgbrdcst-drilldown'>"+o+"</span>"}else{o="<span class='siebui-msgbrdcst-attachment-icon'></span><span class='siebui-msgbrdcst-drilldown'>"+o+"</span>"}}else{if(q===true){o="<span class='siebui-mobile-msgbrdcst-drilldown-text'>"+o+"</span><span class='siebui-mobile-msgbrdcst-drilldown-icon'></span>"}else{o="<span class='siebui-mobile-msgbrdcst-drilldown-text'>"+o+"</span><span class='siebui-mobile-msgbrdcst-attachment-icon'></span>"}}}if(SiebelApp.S_App.IsMobileApplication()==="true"){if(utils.IsEmpty(u)){h+="<span  role='option' tabindex='0' aria-label='Notification Severity :"+f.type+" Notification Summary : "+o+"'>"}else{h+="<span  role='option' tabindex='0' aria-label='Notification Severity :"+f.type+" Notification Summary : "+u+" Hyperlink'>"}h+=o+"</span>"}else{if(utils.IsEmpty(u)){if(p==="Y"){h+="<span class ='"+s+"' id='siebui-delmsg-span' role='option' tabindex='0' aria-label='Notification Severity :"+f.type+" Notification Summary : "+o+"'>"}else{h+="<span class ="+s+" role='option' tabindex='0' aria-label='Notification Severity :"+f.type+" Notification Summary : "+o+"'>"}}else{if(p==="Y"){h+="<span class ='"+s+"' id='siebui-delmsg-span' role='option' tabindex='0' aria-label='Notification Severity :"+f.type+" Notification Summary : "+u+" Hyperlink'>"}else{h+="<span class ="+s+" role='option' tabindex='0' aria-label='Notification Severity :"+f.type+" Notification Summary : "+u+" Hyperlink'>"}}h+=o+"</span>"}return h}else{var g="siebui-msgbar-msg-normal";var n=m_prefixNormal;var l;o=f.body;var m=f.type;var v=o.length+n.length;if(m===m_strUrgent.valueOf()||m===m_strUrgentWA.valueOf()){n=m_prefixUrgent}else{if(m===m_strHigh.valueOf()){n=m_prefixHigh}else{if(m===m_strNormal.valueOf()){n=m_prefixNormal}}}o=HtmlEncode(o);o=o.replace(/\[N\]/g,"<span class='siebui-msgbar-msg-normal'>"+m_prefixNormal);o=o.replace(/\[H\]/g,"<span class='siebui-msgbar-msg-high'>"+m_prefixHigh);o=o.replace(/\[U\]/g,"<span class='siebui-msgbar-msg-urgent'>"+m_prefixUrgent);var k=0;var r="";while(1){k=o.indexOf("<span",k);if(k>0){k+=5}else{break}r+="</span>"}o+=r;o="<span class='"+g+"'>"+n+o+"</span>";return o}}function a(){var f;if(m_strUnRdLtstClrCode!==""){if(m_strUnRdLtstClrCode==="siebui-msgbar-bkgrnd-msg-urgent"){if(m_isUnrdUwA===true){f=m_strUrgentWA.valueOf()}else{f=m_strUrgent.valueOf()}}else{if(m_strUnRdLtstClrCode==="siebui-msgbar-bkgrnd-msg-high"){f=m_strHigh.valueOf()}else{if(m_strUnRdLtstClrCode==="siebui-msgbar-bkgrnd-msg-normal"){f=m_strNormal.valueOf()}}}}else{f=m_strNormal.valueOf()}return f}d.prototype.CloseMainDialog=function(){if($("#Msg_Summary").length>0){$("#Msg_Summary").remove()}};return d}())};
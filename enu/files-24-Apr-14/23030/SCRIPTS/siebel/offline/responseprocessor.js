/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2013 Oracle and/or its affiliates. All rights reserved.
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
if(typeof(SiebelApp.OffResponseProcessor)==="undefined"){Namespace("SiebelApp.OffResponseProcessor");SiebelApp.OffResponseProcessor=(function(){var p=SiebelJS.Dependency("SiebelApp.Constants");var q=SiebelApp.Offlineconstants;SiebelApp.S_App.constructor.prototype.childBCArray=[];SiebelApp.S_App.constructor.prototype.bcArray=[];SiebelApp.S_App.constructor.prototype.bcIndex=0;function l(w){SiebelApp.S_App.childBCArray.push(w)}function v(){return SiebelApp.S_App.bcArray}function r(){return SiebelApp.S_App.childBCArray}function u(){return SiebelApp.S_App.bcIndex}function c(){SiebelApp.S_App.childBCArray=[]}function i(w){SiebelApp.S_App.bcArray.push(w)}function b(){SiebelApp.S_App.bcArray=[]}function h(w){SiebelApp.S_App.bcIndex=w}function a(){SiebelApp.S_App.bcIndex=0}function m(y){var x=CCFMiscUtil_CreatePropSet();x.DecodeFromString(y);var w=p.get("SWE_PST_APP_INFO");if(x.GetChildByType(w)){t.call(this,y)}else{SiebelApp.S_App.DelegateResponse(y)}}function t(ac){try{var Y=CCFMiscUtil_CreatePropSet();Y.DecodeFromString(ac);var C=null;var y=p.get("SWE_PST_APP_INFO");var D=Y.GetProperty(p.get("SWE_RPC_PROP_VIEW"));var Z=p.get("SWE_PST_NEW_VIEW");var x=p.get("SWE_PST_NEW_BUSOBJ");var O=[];var ad;var P=Y.GetChildByType(y);var M=P.GetType();var I=p.get("SWE_PROP_PARENT_ID");var W=p.get("SWE_RPC_PROP_NOTIFICATION");var A=p.get("SWE_PROP_SESSION_RANDOM_NUMBER");if(Y.GetProperty(A)){Y.SetPropertyStr(A,"")}var ab=Y.GetChildCount();for(var H=0;H<ab;H++){var F=Y.GetChild(H);var E=F.GetType();if(E===W){Y.RemoveChild(H);break}}var R=Y.GetProperty(p.get("SWE_RPC_PROP_RETURN_STATUS"));var z=Y.GetProperty(p.get("SWE_RPC_PROP_URL"));if(z&&R){var ah=utils.DecodeFromQueryString(z);if(ah){ah.SetProperty(p.get("SWE_RPC_PROP_RETURN_STATUS"),R);var af=utils.EncodeToQueryString(ah,false);Y.SetProperty(p.get("SWE_RPC_PROP_URL"),(SiebelApp.S_App.GetPageURL()+p.get("SWE_ARG_START")+af))}}C=P;var G;if(C){var w=C.GetChildByType(Z);if(w){ad=w}else{ad=C}G=ad.GetChildByType(p.get("SWE_PST_VIEW_INFO"))}var Q=0;var T=null;var aa=null;var K=null;ad=C.GetChildByType(x);if(!ad){ad=C}var ae=ad.GetChildByType(p.get("SWE_PST_BUSOBJ_INFO"));if(Y.propArray.Status!=="NewPopup"){SiebelApp.OfflineAppMgr.SetContextParam(ae.propArray.n,ae.GetChildCount())}var S=ae.GetChildCount();var U=[];for(var X=0;X<S;X++){var L=ae.GetChild(X);var B={};if(L){var ag=L.GetChildByType(p.get("SWE_PST_BUSCOMP_INFO"));if(ag){K=ag.GetProperty(I);if(K){l.call(this,ag)}else{i.call(this,ag)}B.id=ag.GetValue();B.name=ag.GetProperty("n");U.push(B)}}}O=e.call(this,G,U);var V=v.call(this);if(V.length){var J=false;j.call(this,V[0],O,D,Y,0,J)}}catch(N){b.call(this);a.call(this)}}function o(y,z,B,x,w,A){j.call(this,y,z,B,x,w,A)}function e(B,U){var T=[];var D;var G;var O;var M=B.GetChildCount();var A=false;if(SiebelApp.OfflineAppMgr.GetAppContext().ReqType===q.get("EDIT_FIELD")){A=true}if((SiebelApp.OfflineDataMgr.GetRecordParam()).State||A){var L=SiebelApp.S_App.GetActiveView();var R=L.GetAppletMap();var C=Object.keys(R);var E=C.length;var P;var I;var x;var F;for(var K=0;K<E;K++){D=R[C[K]].GetBusComp().GetName();d.call(this,D,R[C[K]].GetName(),T);if(((SiebelApp.OfflineDataMgr.GetRecordParam()).State===p.get("SWE_PST_APPLET_MODE_EDIT")||(SiebelApp.OfflineDataMgr.GetRecordParam()).State===p.get("SWE_PST_APPLET_MODE_NEW")||A)&&R[C[K]].GetName()===((SiebelApp.OfflineDataMgr.GetRecordParam()).AppletName)){P=R[C[K]].GetFullId();I=R[C[K]].GetBusComp().GetSelection();x=R[C[K]].GetView().GetName();F=R[C[K]].GetName();if(I<0){I=0}}}if(P||(A&&F)){for(O=0;O<M;O++){G=B.GetChild(O);if(A){if((G.GetType()===p.get("SWE_PST_NEW_LIST_APPLET"))){G=G.GetChildByType(p.get("SWE_PST_APPLET_INFO"))}}if(G&&((G.GetType()===p.get("SWE_PST_APPLET_INFO")))&&((G.GetValue()===P))||(A&&F)){if(A){var w="_";w=w.concat(F.toString(),q.get("SHOW_POP_UP").length,"_");G.SetPropertyStr(p.get("SWE_PROP_POP_BKMARK"),w)}var H=G.GetChildByType(p.get("SWE_PST_CNTRL_LIST"));if(H){var N=H.GetChildCount();for(var S=0;S<N;S++){var z=H.GetChild(S);if(z.GetType()===p.get("SWE_PST_CNTRL")){var Q=z.GetChildByType(p.get("SWE_PST_INVK_MTHD_PARAMS"));if(!A){if(Q&&Q.GetProperty(p.get("SWE_ROW_STR"))){Q.SetPropertyStr(p.get("SWE_ROW_STR"),I.toString())}}else{if(A&&Q){if(Q.GetProperty(p.get("SWE_VIEW_ARG"))){Q.SetPropertyStr(p.get("SWE_VIEW_ARG"),x.toString())}if(Q.GetProperty(p.get("SWE_POST_FORCE_STR"))){Q.SetPropertyStr(p.get("SWE_POST_FORCE_STR"),F.toString())}}}}}}break}}}}if(!(SiebelApp.OfflineDataMgr.GetRecordParam()).State||A){for(O=0;O<M;O++){G=B.GetChild(O);if(G&&(G.GetType()===p.get("SWE_PST_NEW_APPLET")||G.GetType()===p.get("SWE_PST_NEW_LIST_APPLET"))){var J=G.GetChildByType(p.get("SWE_PST_APPLET_INFO"));var y=J.GetProperty(p.get("SWE_PST_BUSCOMP_INFO"));D=g.call(this,y,U);d.call(this,D,J.GetProperty(p.get("SWE_PROP_NAME")),T)}}}return T}function g(A,x){var y="";var w=x.length;for(var z=0;z<w;z++){if(x[z].id===A){y=x[z].name;break}}return y}function d(B,y,A){var w=A.length;var C=0;for(var x=0;x<w;x++){if(A[x].bci===B){C=1;break}}if(!C){var z={};z.bci=B;z.applet=y;A.push(z)}}function k(A,z){var w=z.length;var x=null;for(var y=0;y<w;y++){if(z[y].bci===A){x=z[y].applet;break}}return x}function f(D){var z=v.call(this);var y=z.length;var x=null;for(var A=0;A<y;A++){var F=z[A];var w=F.GetValue();if(w===D){var G=F.GetChildByType(p.get("SWE_PST_REC_LIST"));var C=G.GetChildByType(p.get("SWE_PROP_RECORD"));if(C){x=C.GetProperty(p.get("SWE_PROP_ID"))}break}}var B;var H=SiebelApp.OfflineAppMgr.GetAppContext();var E=H.BC.length;for(var I=0;I<E;I++){if((H.BC[I].ParentBC===undefined)){B=H.BC[I].Name}}if(SiebelApp.BrowserCacheMgr.CheckContext(B)){H=SiebelApp.OfflineAppMgr.GetAppContext();if(H.RowId!==""&&H.RowId!==undefined){x=H.RowId}}return x}function s(x,w){var y=x.EncodeAsString();n.call(this);w.DelegateResponse(y)}function n(){b.call(this);c.call(this);a.call(this)}function j(an,O,B,af,Q,I){var ad=p.get("SWE_PROP_NAME");var G=p.get("SWE_PROP_PARENT_ID");var al=p.get("SWE_PROP_LAST_RECORD");var Z=p.get("SWE_PROP_RECORD");var E=p.get("SWE_PROP_ID");var W=v.call(this).length;var S=an.GetProperty(ad);var ah=an.GetValue();if(af.propArray.Status!=="NewPopup"){SiebelApp.OfflineAppMgr.SetBCContext(S,ah,an.GetProperty(G))}var M=an.GetChildByType(p.get("SWE_PST_FIELD_LIST"));var w=[];for(var aj=0;aj<M.GetChildCount();aj++){var A=M.GetChild(aj);if(A&&A.GetType()===p.get("SWE_PROP_NOTI_FIELD")){w.push(SiebelApp.S_App.LookupStringCache(A.GetProperty(ad)))}}var L=an.GetChildByType(p.get("SWE_PST_REC_LIST"));var V=L.GetChildByType(al);var am=null;var H;var D="";var P;if(V){am=V.Clone();P=V.Clone();am.SetType(Z);am.SetPropertyStr(E,D);var F=false;var N=SiebelApp.OfflineAppMgr.GetAppContext();var R=(N.ReqType===q.get("NEWRECORD"))||(N.ReqType===q.get("CREATERECORD"));var ab=N.ReqType===q.get("EDITRECORD");if(af.propArray.Status!=="NewPopup"||((af.propArray.Status!=="NewPopup")&&!R)){if(I===true&&!R&&!ab){N.RowChildNum=0}if(N.RowChildNum!==undefined){for(var X=0;X<N.BC.length;X++){if(N.BC[X].ParentBC!==undefined){L.SetPropertyStr(p.get("SWE_PROP_ACTIVE_ROW"),N.RowChildNum)
}}for(var ae=0;ae<((N.BC.length<N.prevBC.length)?N.BC.length:N.prevBC.length);ae++){if((N.BC[ae].Name!==N.prevBC[ae].Name)){L.SetPropertyStr(p.get("SWE_PROP_ACTIVE_ROW"),0)}else{if(N.prevBC.length===N.BC.length){for(var ag=0;ag<N.BC.length;ag++){if(!R&&!ab){if(N.BC[ag].Name===N.prevBC[ag].Name){L.SetPropertyStr(p.get("SWE_PROP_ACTIVE_ROW"),0)}}}}}}}if(SiebelApp.BrowserCacheMgr.CheckContext(an.GetProperty(ad))){N=SiebelApp.OfflineAppMgr.GetAppContext();var ak=SiebelApp.OfflineDataMgr.GetRecordParam();var T=SiebelApp.OfflineAppMgr.GetAppContext().RowNum?SiebelApp.OfflineAppMgr.GetAppContext().RowNum:0;L.SetPropertyStr(p.get("SWE_PROP_ACTIVE_ROW"),T);for(var aa=0;aa<((N.BC.length<N.prevBC.length)?N.BC.length:N.prevBC.length);aa++){if(((R||ab)&&N.BC[aa].Name===N.prevBC[aa].Name)&&N.nBC===1){L.SetPropertyStr(p.get("SWE_PROP_ACTIVE_ROW"),SiebelApp.OfflineAppMgr.GetAppContext().RowNum?SiebelApp.OfflineAppMgr.GetAppContext().RowNum:0)}}}}if(af.propArray[q.get("STATUS")]===q.get("NEWPOPUP")&&L){L.SetPropertyStr(p.get("SWE_PROP_ACTIVE_ROW"),0)}var C=L.GetChildCount();for(var ai=0;ai<C;ai++){var Y=L.GetChild(0);if(Y&&(Y.GetType()===Z||Y.GetType()===al)){L.RemoveChild(0)}}}var J=k.call(this,S,O);var x=null;var U=u.call(this);var y=SiebelApp.S_App;if(I){var K=an.GetProperty(G);if(K&&K!==""){x=f.call(this,K);if(x===null){L.AddChild(P);if(Q<(W-1)){++Q;o.call(this,r.call(this)[Q],O,B,af,Q,true);L.AddChild(P);return}else{if(U===W){L.AddChild(P);s.call(this,af,y);return}}}}}if(w.length&&S&&J){var z=this;var ac=SiebelApp.S_App.GetActiveView();SiebelApp.BrowserCacheMgr.GetRawRecordSet(B,J,S,w,x,function(aw){U++;SiebelApp.OfflineUtils.Log(S+"....Received some data from BrowserStore");if(aw.length!==0){SiebelApp.OfflineUtils.Log(S+"....Received "+aw.length+" records")}else{if(ac){var ap=ac.GetApplet(J);if(ap&&ap.GetRecordSet()&&(ap.GetRecordSet().length===0)&&((SiebelApp.OfflineDataMgr.GetRecordParam()).State===p.get("SWE_PST_APPLET_MODE_EDIT"))){alert("No Records to Update");SiebelApp.S_App.uiStatus.Free();SiebelApp.OfflineDataMgr.SetNewRecordCommit(false);SiebelApp.OfflineDataMgr.SetRecordParam(false);n.call(this);return}}}if(V){var ao=aw.length;if(ao){for(var at=0;at<ao;at++){var ar="";var au="";ar=aw[at].id;au=aw[at].value;var av=am.Clone();av.SetPropertyStr(E,ar);av.SetPropertyStr(p.get("SWE_PROP_VALUE"),au);L.AddChild(av)}}L.AddChild(P);var aq;if(Q<(W-1)){++Q;aq=I?r.call(this)[Q]:v.call(this)[Q];o.call(this,aq,O,B,af,Q,I)}if(!I&&U===W){if(r.call(this).length){a.call(this);I=true;aq=r.call(this)[0];o.call(this,aq,O,B,af,0,I)}else{s.call(this,af,y)}}else{if(I&&U===W){s.call(this,af,y)}}}})}}}())};
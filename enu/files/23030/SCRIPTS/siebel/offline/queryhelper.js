/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2013 Oracle and/or its affiliates. All rights reserved.
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
if(typeof(SiebelApp.QueryHelper)==="undefined"){Namespace("SiebelApp.QueryHelper");SiebelApp.QueryHelper=(function(){var b=SiebelApp.Utils;function e(){var i;j=function j(){return i};j.prototype=this;i=new j();i.constructor=j;return i}var c=new e();var a;var h;var d;var f;var g;e.prototype.SetContext=function(i,j,k){a=i;f=j;g=k};e.prototype.GetContext=function(i){return a};e.prototype.GetValue=function(i){return f};e.prototype.DeleteContext=function(){a=""};e.prototype.EvaluateConstantNode=function(i){var j=i.value.replace(/['"]/g,"");return j};e.prototype.EvaluateConstantFunctionNode=function(i){var j="";switch(i.value.toUpperCase()){case"PARENTBCNAME":var k=SiebelApp.QueryHelper.GetContext();if(k){j=k.GetParentBusComp()?k.GetParentBusComp().GetName():""}break;case"TIMESTAMP":j=SiebelApp.OfflineUtils.GetTS();break;case"TODAY":j=new SiebelApp.S_App.DatumUTCDateTimeObject();j.SetToNow();break;case"LANGUAGE":j=SiebelApp.S_App.Model.GetLanguage();break;case"POSITIONID":j=SiebelApp.S_App.Model.GetPositionId();break;case"LOGINID":j=SiebelApp.S_App.Model.GetLoginId();break;case"LOGINNAME":j=SiebelApp.S_App.Model.GetLoginName();break}return j};e.prototype.EvaluateIdentifierNode=function(i){return i.value};e.prototype.EvaluateConstantNumberNode=function(i){var j=i.value.replace(/['"]/g,"");return +j};e.prototype.EvaluateFieldNameNode=function(u){var A=u.arguments;var l="";var k="";var t;for(var x=0;x<A.length;x++){l+=A[x].evaluate();k+=A[x].evaluate()+" "}var j=SiebelApp.QueryHelper.GetContext();var m;if(!g){m=j.GetWS()[j.GetActiveRow()]}else{m=g}var z="";var p="";t=m[l];try{z=j.GetFieldDefn(k.substring(0,k.length-1))}catch(n){return""}if(z!==null||z!==""){switch(z.DataType){case"1":p=b.IsEmpty(t)?"":t;break;case"2":p=b.IsEmpty(t)?"":t;break;case"3":p=new SiebelApp.S_App.DatumPhoneObject();p.SetAsString(t);break;case"4":p=b.IsEmpty(t)?"":t;break;case"5":p=b.IsEmpty(t)?"":t;break;case"6":p=b.IsEmpty(t)?"":t;break;case"7":break;case"8":p=new SiebelApp.S_App.DatumBoolObject();p.SetValue(t);break;case"9":if(b.IsEmpty(t)){p="";break}p=+t;break;case"10":if(b.IsEmpty(t)){p="";break}var D=+t.substring(0,2);var C=+t.substring(3,5);var q=+t.substring(6,10);p=new SiebelApp.S_App.DatumDateObject();p.SetDate(q,D,C);break;case"11":p=new SiebelApp.S_App.DatumTimeObject();var y=+t.substring(0,2);var w=+t.substring(3,5);var r=+t.substring(6,8);var o=(60*w+60*60*y+r);p.SetValue(o);break;case"12":break;case"13":if(b.IsEmpty(t)){p="";break}var D=+t.substring(0,2);var C=+t.substring(3,5);var q=+t.substring(6,10);var E=+t.substring(11,13);var v=+t.substring(14,16);var B=+t.substring(17,19);var s=t.substring(20,22);if(s.toUpperCase()==="PM"){E=E+12}p=new SiebelApp.S_App.DatumUTCDateTimeObject();p.SetDateTime(q,D,C,E,v,B);break;case"14":break;case"15":break;default:break}}return p};e.prototype.EvaluateUnaryNotNode=function(k){var j=k.evaluate();var i=j===true?false:true;return i};e.prototype.EvaluateUnaryIsNullNode=function(j){var i=j.evaluate();if(b.IsEmpty(i)){return true}return false};e.prototype.EvaluateIfNullNode=function(j){var l=j.args.parameters[0];var k=j.args.parameters[1];var i=l.evaluate();if(b.IsEmpty(i)){i=k.evaluate()}return i};e.prototype.EvaluateUnaryIsNotNullNode=function(j){var i=j.evaluate();if(b.IsEmpty(i)){return false}return true};e.prototype.EvaluateIIFNode=function(i){var l=i.args.parameters[0];var k=i.args.parameters[1];var j=i.args.parameters[2];if(l.evaluate()){return k.evaluate()}else{return j.evaluate()}};e.prototype.EvaluateRowIdToRowIdNumNode=function(k){var q=k.args.parameters[0].evaluate();if(typeof(q)=="object"){q=q.GetId()}var j=q.length;var p=0;var m=0;var o="";do{var n=q.charAt(m);var l=n.charCodeAt(0);if(!isNaN(parseInt(n))){if(n>=0&&n<=9){p=p*36+parseInt(n)}}else{if(l>="A".charCodeAt(0)&&l<"Z".charCodeAt(0)){p=p*36+parseInt((l-"A".charCodeAt(0)+10))}else{o+=p.toString();p=0;if(n){o+=n}}}m++}while(m<=j);return o};e.prototype.EvaluateParentFieldValueNode=function(i,j){return false};e.prototype.EvaluateFieldValueNode=function(i,j){return false};e.prototype.EvaluateLookupValueNode=function(i){var m=i.args.parameters[0].param;var l=i.args.parameters[1].param;var k=m.evaluate();var j=l.evaluate();return SiebelApp.S_App.Model.GetLovNameVal(j,k)};e.prototype.EvaluateLookupNameNode=function(i){var m=i.args.parameters[0].param;var l=i.args.parameters[1].param;var k=m.evaluate();var j=l.evaluate();return SiebelApp.S_App.Model.GetLovValName(j,k)};e.prototype.EvaluateIsNullNode=function(i){var l=i.args[0];var k=i.args[1];var j=l.evaluate();if(!b.IsEmpty(j)){return j}else{return k.evaluate()}};e.prototype.EvaluateLeftNode=function(i){var m=i.args[0];var l=i.args[1];var j=m.evaluate();var k=l.evaluate();return j.substring(0,k)};e.prototype.EvaluateRightNode=function(j){var m=j.args[0];var l=j.args[1];var k=m.evaluate();var i=l.evaluate();return k.substring(k.length-i)};e.prototype.EvaluateMidNode=function(i){var n=i.args[0];var m=i.args[1];var l=i.args[2];var k=n.evaluate();var o=m.evaluate();var j=l.evaluate();return k.substring(o,j)};e.prototype.EvaluateBinaryOpNode=function(j){var m=(j.left==="NULL")?SiebelApp.QueryHelper.GetValue().body.evaluate():j.left.evaluate();var l=(j.right==="NULL")?SiebelApp.QueryHelper.GetValue().body.evaluate():j.right.evaluate();var k=j.type;var i;switch(k){case"BINOPNODE_APLUS":if(typeof m.add==="function"&&typeof l.add==="function"){i=m.add(l)}else{if(typeof m.add==="function"&&(typeof l.add!=="function")){i=m.add(l)}else{if((typeof m.add!=="function")&&typeof l.add==="function"){i=l.add(m)}else{i=m+l}}}break;case"BINOPNODE_AMINUS":if(typeof m.subtract==="function"&&(typeof l.subtract!=="function")){i=m.subtract(l)}else{if((typeof m.subtract!=="function")&&typeof l.subtract==="function"){i=l.subtract(m)}else{i=m-l}}break;case"BINOPNODE_AMULTIPLY":i=m*l;break;case"BINOPNODE_ADIVIDE":if(typeof m.divide==="function"&&typeof l.divide==="function"){i=m.divide(l)}else{i=m/l}break;case"BINOPNODE_APOWER":i=Math.pow(m,l);break;case"EQUAL":i=(m===l)?true:false;break;case"BINOPNODE_OR":if(m||l){i=true}else{i=false}break;case"BINOPNODE_AND":if(m&&l){i=true}else{i=false}break;case"BINOPNODE_CEQ":if(m===l){i=true}else{i=false}break;case"BINOPNODE_CNE":case"NOT_EQUAL":i=(m!==l)?true:false;break;case"BINOPNODE_CLE":if(m<=l){i=true}else{i=false}break;case"BINOPNODE_CGE":if(m>=l){i=true}else{i=false}break;case"BINOPNODE_CLT":if(typeof m.less==="function"&&typeof l.less==="function"){i=m.less(l)}else{if(m<l){i=true}else{i=false}}break;case"BINOPNODE_CGT":if(typeof m.greater==="function"&&typeof l.greater==="function"){i=m.greater(l)}else{if(m>l){i=true}else{i=false}}break}return i};e.prototype.EvaluateParentFieldValueNode=function(i){var l=i.args.parameters[0].evaluate();var k=SiebelApp.QueryHelper.GetContext();var j;if(b.IsEmpty(k.GetParentBusComp().GetWS()[0][l])){j=""}else{j=k.GetParentBusComp().GetWS()[0][l]}return j};e.prototype.BinaryOpNodeBoldQuery=function(q){var l=q.left;var s=q.right;var n=q.type;var o=" ";var m;var r;if(n!=="BINOPNODE_OR"&&n!=="BINOPNODE_AND"){switch(n){case"BINOPNODE_CEQ":k="=";
break;case"BINOPNODE_CNE":k="<>";break;case"BINOPNODE_CLT":k="<";break;case"BINOPNODE_CGT":k=">";break;case"BINOPNODE_CLE":k="<=";break;case"BINOPNODE_CGE":k=">=";break;case"BINOPNODE_CLIKE":k="LIKE";break}r=s.evaluate();m=l.BoldQuery();if(typeof r.GetAsFormattedString==="function"){var p=SiebelApp.S_App.LocaleObject.m_sTimeZoneName.substring(5,10);if(SiebelApp.S_App.LocaleObject.m_sTimeZoneName.charAt(4)==="+"){r.AddTime(0,0,-Math.abs(((+p.substring(0,2))*3600-(+p.substring(3,5))*60)));var j=r.GetAsFormattedString("YYYYMMDD%");r.AddDays(2);var i=r.GetAsFormattedString("YYYYMMDD%");o=m+' >  "'+j+'"  AND '+m+' <  "'+i+'" '}else{r.AddTime(0,0,Math.abs(((+p.substring(0,2))*3600-(+p.substring(3,5))*60)));var j=r.GetAsFormattedString("YYYYMMDD%");r.AddDays(2);var i=r.GetAsFormattedString("YYYYMMDD%");o=m+' >  "'+j+'"  AND '+m+' <  "'+i+'" '}return"("+o+")"}r='"'+r+'"';o+="("+m+" "+k+" "+r+")";return o}if(n==="BINOPNODE_OR"||n==="BINOPNODE_AND"){m=l.BoldQuery();r=s.BoldQuery();var k=(n==="BINOPNODE_OR")?"OR":"AND";o="("+m+" "+k+" "+r+")";return o}};e.prototype.BoldQueryFieldNameNode=function(k){var r=k.arguments;var j="";var q="";var n="";var p=SiebelApp.QueryHelper.GetContext();var l=false;var v=SiebelApp.OfflineUtils.RemoveNonAlphaChars(p.GetName());var u=p.GetParentBusComp();if(u){var o=p.GetLinkDef();if(o.interTableName){l=true}}for(var m=0;m<r.length;m++){j+=r[m].evaluate();n+=r[m].evaluate()+" "}var w=n.trim();var q=SiebelApp.OfflineUtils.RemoveNonAlphaChars(j);if(!(SiebelApp.BrowserCacheMgr.DoesFieldExist(v,q))){SiebelJS.Log("Field"+q+"from the BC "+v+" not found")}if(l){if(p.GetDefn().InterFieldInfo.InterFieldArr.indexOf(j)!==-1){var t=p.GetDefn().Fields[j].ColName;if(SiebelApp.BrowserCacheMgr.DoesFieldExist(o.interTableName,t)){q=SiebelApp.OfflineUtils.RemoveNonAlphaChars(o.interTableName)+"."+t}else{SiebelJS.Log("Column"+t+"from the intertable "+o.interTableName+" not found")}}else{q=v+"."+q}}if(p.GetDefn().Fields[w].DataType==="10"||p.GetDefn().Fields[w].DataType==="12"||p.GetDefn().Fields[w].DataType==="13"){var s;s=p.DateFormatConverter(s,j);return s}return q};e.prototype.BoldQueryUnaryIsNullNode=function(j){var i=j.BoldQuery();var k="";k+=i+' = ""';return k};e.prototype.BoldQueryUnaryIsNotNullNode=function(j){var i=j.BoldQuery();var k="";k+=i+' <> ""';return k};e.prototype.BoldQueryBracesNode=function(i){var j="";j=" ("+i.body.BoldQuery()+") ";return j};e.prototype.BoldQueryFunctionNode=function(i){var j="";switch(i.name){case"EXISTS":j="1=1"}return j};e.prototype.BoldQueryParameterListNode=function(k){var l="";for(var j=0;j<k.parameters.length;j++){l=l+k.parameters[j].BoldQuery()}return l};e.prototype.BoldQueryParameterNode=function(i){var j="";j=i.param.BoldQuery();return j};return c}())};
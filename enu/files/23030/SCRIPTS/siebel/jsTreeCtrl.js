/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2013 Oracle and/or its affiliates. All rights reserved.
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
if(typeof(SiebelAppFacade.JSTreeRenderer)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.JSTreeRenderer");define("siebel/jsTreeCtrl",[],function(){SiebelAppFacade.JSTreeRenderer=(function(){var d=SiebelJS.Dependency("SiebelApp.Constants");var c=d.get("SWE_SCREEN_NAV_CONTROL_STR");var a=d.get("SWE_AGGR_VIEW_NAV_CONTROL_STR");var f=d.get("SWE_DET_VIEW_NAV_CONTROL_STR");var b=d.get("SWE_DET_SUB_VIEW_NAV_CONTROL_STR");function e(k){var i=k;this.GetPM=function(){return i};var l={};this.GetDataSet=function(){return l};this.EmptyDataSet=function(){l={}};if(this.GetPM().Get("IsScreen")){this.GetPM().AttachPMBinding("Refresh",this.BindData,{scope:this})}this.GetKey=function(){var n=d.get("SWE_PROP_NC_ID_SCREEN_CONTROL");var m=this.GetPM().Get("IsScreen")?"screenName":"viewName";this.GetKey=function(){return m};return m};var j=this;$(window).resize(function(){if(j.TreeLoaded){j.Refresh(true)}})}e.prototype.ShowUI=function(){var j=this.GetPM();var i=j.Get("GetType");var k=$("#"+i);SiebelJS.Log("[JSTreeRenderer] -> jqcontainer = "+k.length);if(i===d.get("SWE_PROP_NC_ID_VIEW_CONTROL")){if(($("div#"+d.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL"))).length!==0){i=d.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL")}}j.SetProperty("LevelPlaceholder",i);h.call(this,k)};function h(l){var k=this;if(l.length===1){l.dynatree({autoCollapse:true,imagePath:" ",classNames:{nodeIcon:null},clickFolderMode:3,minExpandLevel:1,persist:false,expandOnAdd:true,onPostInit:function(n,m){this.reactivate()},onClick:function(p,o){var r;var m=k.GetPM();if(p&&p.getEventTargetType(o)==="title"&&p.data.key){var s;if(p.data.isFolder===true){if(k.GetDataSet()!==null){r=k.GetDataSet()[p.data.key];s=r[m.Get("IsScreen")?"defaultViewName":k.GetKey()];r.viewName=s;if(m.Get("GetType")===d.get("SWE_PROP_NC_ID_SCREEN_CONTROL")){r.level=c}else{r.level=f}}}else{var n=m.Get("GetSelectedTabKey");var q=null;if(n!==null&&n!==undefined){r=m.Get("GetTabInfo")[n]}s=r.links[p.data.key].viewName;r.viewName=s;if(m.Get("GetType")===d.get("SWE_PROP_NC_ID_SCREEN_CONTROL")){r.level=a}else{r.level=b}}if(!m.OnControlEvent("OnClick",r)){return false}}return true}});var j=k.GetPM();var i=(j.Get("GetType")===d.get("SWE_PROP_NC_ID_SCREEN_CONTROL"))?"siebui-view-navs":"siebui-subview-navs";if(!l.hasClass(i)){l.addClass(i)}this.TreeLoaded=true}}e.prototype.BindEvents=function(){};e.prototype.BindData=function(){var j=this.GetPM();var q=j.Get("GetDataReload");var i=j.Get("GetTabInfo");var o=j.Get("GetSelectedTabLinkInfo");var p;var m;if(q){this.EmptyDataSet()}var l=this.GetDataSet();var k={};if(i!==null&&(q)){for(m in i){if(i.hasOwnProperty(m)){if(m.search("tabScreen")===-1){continue}p=i[m];l[p[this.GetKey()]]=p}}}var n=j.Get("GetSelectedTabKey");var t=null;if(n!==null&&n!==undefined&&i[n]!==undefined){t=i[n][this.GetKey()]}var r=false;if(o!==null&&l[t]!==undefined&&l[t].links===undefined){var s=false;for(m in o){if(o.hasOwnProperty(m)){if(m.search("tabView")===-1){continue}p=o[m];k[p.viewName]=p;s=true}}if(s){l[t].links=k;r=true}}if(q){r=true}this.Refresh(r)};e.prototype.Refresh=function(I){if(!I){return}var o=this.GetPM();if($("#"+o.Get("GetType")).dynatree("getRoot").length===0){return}$("#"+o.Get("GetType")).dynatree("getRoot").removeChildren();var k=o.Get("GetTabInfo")||{};var E=o.Get("GetSelectedTabLinkInfo")||{};var l=$("#"+o.Get("GetType")).dynatree("getRoot");var j;var u;var N;var x=true;if(o.Get("IsScreen")){j=l.addChild({title:"Screens",key:"AllScreens",addClass:"dynatree-root-tag",isFolder:true,expand:true,url:null})}else{j=l}var y=o.Get("GetSelectedTabKey");var Q=null;if(y!==null&&y!==undefined){Q=(k[y]||k.tabScreen0)[this.GetKey()]}Q=String(Q);var p=o.Get("GetSelectedLinkKey");var v=null;if(p!==null&&p!==undefined){v=E[p]?E[p].viewName:""}v=String(v);var n=($("#"+o.Get("GetType")).width())>($("#"+o.Get("GetType")).height())?1:0;var i=n?$("#"+o.Get("GetType")).width():$("#"+o.Get("GetType")).height();var m=45;var J=false;var B="j_"+o.Get("GetType");var C=(o.Get("IsScreen"))?"siebui-nav-screenlist":"siebui-nav-viewlist";var s='<select id="'+B+'" class="'+C+'"><option></option>';var P=false;var M=(o.Get("GetTabInfo")[o.Get("GetSelectedTabKey")]||o.Get("GetTabInfo")["tabScreen0"]);var t=null;t=j.addChild({title:M.captionName,isFolder:true,url:M.captionName,icon:M.tabIcon,activate:(M.captionName===Q),addClass:(M.captionName===Q)?"screen-tab-selected":"screen-tab-deselected",expand:M.captionName===Q,key:M});var A=$($(t)[0].li).outerWidth(true);m+=A;j.removeChildren();$("#"+B).remove();var w=0;var K=0;var O=this.GetDataSet();for(var R in O){if(O.hasOwnProperty(R)){if(!J){u=j.addChild({title:O[R].captionName,isFolder:true,url:O[R].captionName,icon:O[R].tabIcon,activate:(R===Q),addClass:(R===Q)?"screen-tab-selected":"screen-tab-deselected",expand:R===Q,key:R});if(R===Q){P=true;m-=A}var F=this.GetDataSet()[R].links;for(N in F){if(F.hasOwnProperty(N)){if(x&&o.Get("LevelPlaceholder")===d.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL")){h.call(this,$("#"+o.Get("LevelPlaceholder")));if($("#"+o.Get("LevelPlaceholder")).dynatree("getRoot").length===0){return}$("#"+o.Get("LevelPlaceholder")).dynatree("getRoot").removeChildren();u=$("#"+o.Get("LevelPlaceholder")).dynatree("getRoot");x=false}var D=u.addChild({title:F[N].captionName,isFolder:false,url:F[N].captionName,activate:N===v,addClass:(o.Get("LevelPlaceholder")===d.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL")?((N===v)?"screen-tab-selected":"screen-tab-deselected"):((N===v)?"view-tab-selected":"view-tab-deselected")),key:N})}}var z=n?$($(u)[0].li).outerWidth(true):$($(u)[0].li).outerHeight(true);if((m+z)<=i){m+=z}else{if(n){J=true;u.remove();s+="<option value = "+(this.GetDataSet()[R].captionName)+">"+(this.GetDataSet()[R].captionName)+"</option>";K++}}}else{s+="<option value = "+(this.GetDataSet()[R].captionName)+">"+(this.GetDataSet()[R].captionName)+"</option>";K++}w++}}if(J){s+="</select>";$("#"+o.Get("GetType")).append(s);var q=this.GetDataSet()[Q].captionName;$("#"+B).find("option").each(function(){if(String(q)===$(this).text()){$(this).remove()}})}if(!P){var r=(o.Get("IsScreen"))?String(M.screenName):String(M.viewName);u=j.addChild({title:M.captionName,isFolder:true,url:M.captionName,icon:M.tabIcon,activate:(r===Q),addClass:(r===Q)?"screen-tab-selected":"screen-tab-deselected",expand:r===Q,key:r});for(N in M.links){if(M.links.hasOwnProperty(N)){var G=u.addChild({title:M.links[N].captionName,isFolder:false,url:M.links[N].captionName,activate:N===v,key:N})}}}var H=this;$("#"+B).change(function(){var U=$("#"+B).find("option:selected").text();var S=H.GetDataSet();var V="";for(var T in S){if(S.hasOwnProperty(T)){if(U===String(S[T].captionName)){V=S[T].viewName;S[T]["level"]=f;if(!V){S[T]["viewName"]=S[T].defaultViewName}o.OnControlEvent("OnClick",S[T])}}}});var L={};L.comboContainer=B;L.chtotal=w;L.count=K;L.overflow=J;g.call(this,j,L)};function g(y,A){var p=this.GetPM();var r=p.Get("GetTabContainerQTPInfo");var k=p.Get("GetTabItemsQTPInfo");var u=p.Get("IsScreen")?(p.Get("GetTabInfo")[p.Get("GetSelectedTabKey")]&&p.Get("GetTabInfo")[p.Get("GetSelectedTabKey")].screenName):(p.Get("GetTabInfo")[p.Get("GetSelectedTabKey")]&&p.Get("GetTabInfo")[p.Get("GetSelectedTabKey")].viewName);
var x=p.Get("GetTabViewLinkContainerQTPInfo");var m=p.Get("GetTabViewLinkItemsQTPInfo");var q=d.get("SWE_PROP_QTP_OT");var w=d.get("SWE_PROP_QTP_RN");var v=d.get("SWE_PROP_QTP_UN");if(r&&(typeof(r.GetProperty)==="function")){y.ul.setAttribute("ot",r.GetProperty(q));y.ul.setAttribute("rn",r.GetProperty(w));y.ul.setAttribute("un",r.GetProperty(v))}for(var t=0;t<y.getChildren().length;t++){var l=y.getChildren()[t];if(k[t]&&(typeof(k[t].GetProperty)==="function")){l.li.setAttribute("ot",k[t].GetProperty(q));l.li.setAttribute("rn",k[t].GetProperty(w));l.li.setAttribute("un",k[t].GetProperty(v))}if((l.getChildren()!==null)&&(u===l.data.key)){if(x&&(typeof(x.GetProperty)==="function")){l.ul.setAttribute("ot",x.GetProperty(SiebelApp.Constants.get(q)));l.ul.setAttribute("rn",x.GetProperty(SiebelApp.Constants.get(w)));l.ul.setAttribute("un",x.GetProperty(SiebelApp.Constants.get(v)))}for(var s=0;s<l.getChildren().length;s++){var o=l.getChildren()[s];if(m[s]&&(typeof(m[s].GetProperty)==="function")){o.li.setAttribute("ot",m[s].GetProperty(q));o.li.setAttribute("rn",m[s].GetProperty(w));o.li.setAttribute("un",m[s].GetProperty(v))}}}}if(!A.overflow){return}var y=$("#"+A.comboContainer);var z=p.Get("GetJumpTabQTPInfo");var q=d.get("SWE_PROP_QTP_OT");var w=d.get("SWE_PROP_QTP_RN");var v=d.get("SWE_PROP_QTP_UN");var n=A.chtotal-A.count;if(z&&(typeof(z.GetProperty)==="function")){y.attr("ot",z.GetProperty(q));y.attr("rn",z.GetProperty(w));y.attr("un",z.GetProperty(v))}l=y.children("option");var s=1;for(t=n;t<A.chtotal&&l.length>0;t++){if(k[t]&&(typeof(k[t].GetProperty)==="function")){l.eq(s).attr("ot",k[t].GetProperty(q));l.eq(s).attr("rn",k[t].GetProperty(w));l.eq(s).attr("un",k[t].GetProperty(v));s++}}}return e}());return"SiebelAppFacade.JSTreeRenderer"})};
if(typeof(SiebelAppFacade.JQMCalListRenderer)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.JQMCalListRenderer");if(typeof(SiebelApp)!=="undefined"&&typeof(SiebelApp.S_App)!=="undefined"){if(typeof(SiebelApp.Constants)!=="undefined"){SiebelApp.S_App.RegisterConstructorAgainstKey(SiebelApp.Constants.get("SWE_UIDEF_CALAPPLET_PRENDR"),"SiebelAppFacade.JQMCalListRenderer")}}SiebelAppFacade.JQMCalListRenderer=(function(){var b=SiebelJS.Dependency("SiebelApp.Constants");function c(f){SiebelAppFacade.JQMCalListRenderer.superclass.constructor.call(this,f);var e=this.GetPM();e.AddProperty("NeedUpdate",true);e.AddMethod("NotifyGetDate",d);e.AttachEventHandler(b.get("PHYEVENT_INVOKE_CONTROL"),a);e.AttachNotificationHandler(b.get("SWE_PROP_BC_NOTI_GENERIC"),function(g){e.ExecuteMethod("NotifyGetDate",g)},{scope:this});e.AttachNotificationHandler(b.get("SWE_PROP_BC_NOTI_NEW_RECORD_DATA_WS"),function(g){e.AddProperty("IsImplicitCommit",true)});e.AttachNotificationHandler(b.get("SWE_PROP_BC_NOTI_NEW_RECORD_DATA"),function(g){e.AddProperty("IsImplicitCommit",true)});e.AttachPMBinding("ShowSelection",function(){e.AddProperty("NeedUpdate",false);e.ExecuteMethod("InvokeMethod","GetCurrentDate")},{when:function(){return e.Get("NeedUpdate")}});e.AttachPMBinding("NotifyGetDate",function(){var g=e.Get("GetControls");for(var i in g){if(g.hasOwnProperty(i)){var h=g[i];if($("#"+h.GetInputName()+"_label").length!==0&&$("[name="+h.GetInputName()+"]").length!==0){$("#"+h.GetInputName()+"_label").text(e.Get("CurrentDate"))}}}},{scope:this})}SiebelJS.Extend(c,SiebelAppFacade.JQMListRenderer);function a(){if(this.inProgress){return false}this.AddProperty("NeedUpdate",true)}function d(f){if(f.GetProperty(b.get("SWE_PROP_NOTI_TYPE"))==="MobileCurrentDate"){var j=f.GetProperty(b.get("SWE_PROP_ARGS_ARRAY"));var l=[];if(j){CCFMiscUtil_StringToArray(j,l)}var g=CCFMiscUtil_CreatePropSet();for(var h=0;h<l.length;h++){g.SetProperty(h.toString(),l[h])}var k=CCFMiscUtil_CreatePropSet();var e=k.DecodeFromString(g.GetProperty("0"));if(e===false){return}this.AddProperty("CurrentDate",k.GetProperty("CurrentDate"))}}c.prototype.ShowUI=function(e){SiebelAppFacade.JQMCalListRenderer.superclass.ShowUI.call(this,e);var f=("#s_S_A"+this.GetPM().Get("GetId")+"_div");this.CreateUIButtons();$(f).find("tr.AppletButtons").css("display","");if(!this.GetPM().Get("IsImplicitCommit")){this.GetPM().AddProperty("NeedUpdate",true)}};c.prototype.ShowSelection=function(){SiebelAppFacade.JQMCalListRenderer.superclass.ShowSelection.call(this)};c.prototype.BindData=function(e){SiebelAppFacade.JQMCalListRenderer.superclass.BindData.call(this,e)};c.prototype.BindEvents=function(e){SiebelAppFacade.JQMCalListRenderer.superclass.BindEvents.call(this,e)};c.prototype.CreateUIButtons=function(){var o=(new Date()).getFullYear();var f={dFormat:"mm/dd/yy",tFormat:"HH:ii:ss",dOrder:"mmddyy",tWheels:"HHiiss"};var h=this.GetPM();var p=h.Get("GetControls");for(var l in p){if(p.hasOwnProperty(l)){var k=p[l];var e=k.GetUIType();if(e===b.get("SWE_CTRL_DATE_TZ_PICK")){var n=false;var g=this.GetPM().Get("ListOfColumns");for(var j=0;j<g.length;j++){if(typeof g[j]!=="undefined"&&g[j].control===k){n=true;break}}if(!n){this.ConvertLocale(f);var m=$("[name="+k.GetInputName()+"]").scroller({preset:"date",dateOrder:f.dOrder,dateFormat:f.dFormat,endYear:o+10,startYear:o-50,onSelect:function(s,v){var t=new Date(s);var r=new Date(t.getTime()+1000*60*60*24);var q=("0"+(t.getMonth()+1)).slice(-2)+"/"+("0"+t.getDate()).slice(-2)+"/"+t.getFullYear();var u=("0"+(r.getMonth()+1)).slice(-2)+"/"+("0"+r.getDate()).slice(-2)+"/"+r.getFullYear();var i=CCFMiscUtil_CreatePropSet();i.SetProperty("StartDate",q);i.SetProperty("EndDate",u);h.AddProperty("NeedUpdate",true);h.ExecuteMethod("InvokeMethod","GotoDay",i)},onShow:function(i,q){q.setDate(new Date(h.Get("CurrentDate")))}});$("[name="+k.GetInputName()+"]").parent().prepend("<div id='"+k.GetInputName()+"_label'></div>");$("#"+k.GetInputName()+"_label").addClass("mobileCalDatePicker");$("#"+k.GetInputName()+"_label").click(function(){m.scroller("enable");m.scroller("show")});$("[name="+k.GetInputName()+"]").css("display","none")}}}}};c.prototype.BindControlEvents=function(g){if(typeof(g.GetInputName)!=="function"){return}var i=$("[name="+g.GetInputName()+"]");var h=b.get("SWE_CTRL_DATE_TIME_PICK");var e=b.get("SWE_CTRL_DATE_PICK");var f=b.get("SWE_CTRL_DATE_TZ_PICK");switch(g.GetUIType()){case e:case h:case f:i.bind("focus",{ctx:this,ctrl:g},function(j){j.data.ctx.GetPM().OnControlEvent(b.get("PHYEVENT_VALUE_FOCUS"),j.data.ctrl,$(this).val())});break;default:SiebelAppFacade.JQMCalListRenderer.superclass.BindControlEvents.call(this,g);break}};return c}())};
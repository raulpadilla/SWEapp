if(typeof(SiebelAppFacade.JQMListRenderer)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.JQMListRenderer");if(typeof(SiebelApp)!=="undefined"&&typeof(SiebelApp.S_App)!=="undefined"){if(typeof(SiebelApp.Constants)!=="undefined"){SiebelApp.S_App.RegisterConstructorAgainstKey(SiebelApp.Constants.get("SWE_UIDEF_LIST_PRENDR"),"SiebelAppFacade.JQMListRenderer")}}SiebelAppFacade.JQMListRenderer=(function(){var i=SiebelJS.Dependency("SiebelApp.Utils");var d=SiebelJS.Dependency("SiebelApp.Constants");var f=d.get("SWE_PST_BUTTON_CTRL");var b=d.get("SWE_CTRL_LINK");var c=SiebelApp.S_App.LocaleObject.GetLocalString("IDS_SWE_MOBILE_NO_RECORDS_TO_DISPLAY");var a=SiebelApp.S_App.LocaleObject.GetLocalString("IDS_SWE_MOBILE_TAP_TO_CREATE");function e(q){SiebelAppFacade.JQMListRenderer.superclass.constructor.call(this,q);var r;var s;var u;var j;var p;var o;var v=false;var l=false;this.GetJQMList=function(){return r};this.SetJQMList=function(w){r=w};this.GetJQMListId=function(){return s};this.SetJQMListId=function(w){s=w};this.GetRowCount=function(){return(s.children().size())};this.GetCurRowSel=function(){return p};this.SetCurRowSel=function(w){p=w};this.GetDelControl=function(){return u};this.SetDelControl=function(w){u=w};this.GetDelBtnStatus=function(){return j};this.SetDelBtnStatus=function(w){j=w};this.GetToggleFlag=function(){return v};this.SetToggleFlag=function(w){v=w};this.GetDisableToggle=function(){return l};this.SetDisableToggle=function(w){l=w};var k=new SiebelAppFacade.JQMMapCtrl(this);this.GetMapCtrl=function(){return k};var t=null;this.SetMapFieldArray=function(){t=this.GetPM().Get("GetMapFields")};this.GetMapFieldArray=function(){return t};var n=null;this.GetMapLocationArray=function(){return n};this.SetMapLocationArray=function(w){n=w};var m;this.GetMapControl=function(){return m};this.SetMapControl=function(w){m=w};this.GetPM().AttachPMBinding("HandleRowSelect",function(){if(!this.GetDisableToggle()){SiebelAppFacade.JQMLayout.ToggleMobileLayout(true)}},{scope:this,when:function(){return $("#"+this.GetPM().Get("GetFullId")).parent().children("div[enabletoggle='true']").length===1||$("#s_"+this.GetPM().Get("GetFullId")+"_div").children("div[enabletoggle='true']").length===1}})}SiebelJS.Extend(e,SiebelAppFacade.JQMScrollContainer);function g(m,j,k,n,l){if(l===""){return'<a id = "listcol_'+n+"_"+k+'" href="javascript:void(0);" class="listdrilldown '+m+'" name="'+j+'"></a>'}else{return'<a id = "listcol_'+n+"_"+k+'" href="javascript:void(0);" class="listdrilldown '+m+'" name="'+j+'">'+l+"</a>"}}e.prototype.ShowUI=function(r){SiebelAppFacade.JQMListRenderer.superclass.ShowUI.call(this);this.m_Offset=0;var k=this.GetPM();k.GetProxy().SetActiveControl(null);var o=k.Get("GetPlaceholder");var s="scrollviewcontainer_"+o;$("#"+o).html("<div id='"+s+"'></div>");this.SetJQMList($("#"+s));var n="jqml_"+o;this.GetJQMList().html("<ul id='"+n+"'></ul>");var j=$("#s_"+k.GetProxy().GetFullId()+"_div");this.SetJQMListId($("#"+n));var m=this.GetJQMListId();m.attr({"data-role":"listview","data-inset":"true"});m.data("IsSwipeRight",false);m.listview();this.MakecontainerScrollable(s,true,false,true);this.SetMapFieldArray();if($("#"+k.GetProxy().GetFullId()).parent().children("div[enabletoggle='true']").length===1||$("#s_"+k.GetProxy().GetFullId()+"_div").children("div[enabletoggle='true']").length===1){this.SetToggleFlag(true)}if(this.IsPopup()){var q=SiebelApp.S_App.GetActiveView().GetActiveApplet();if(q!==undefined&&q!==null){var l=q.GetActiveControl();if(l===undefined||l===null){var p=q.GetParentApplet();if(p!==undefined&&p!==null){l=p.GetActiveControl();if(l===undefined||l===null){l=p.GetControl(q.GetPopupControl())}}}if(l!==undefined&&l!==null){this.SetPopupType(l.GetPopupType())}else{this.SetPopupType("Assoc")}}}else{this.SetPopupType("")}this.ShowSearch();o=null;j=null};e.prototype.ShowSearch=function(){if(false===this.IsPopup()){var n=this.GetPM().Get("GetPlaceholder");var l=[];var m=this.GetPM().Get("ListOfColumns");for(var k=0,j=m.length;k<j;k++){l.push(m[k].control.GetDisplayName())}this.GetSearchCtrl().ShowUI(l,n)}};function h(j,m){var n=SiebelApp.S_App.GetIconMap();var o=SiebelApp.S_App.LookupStringCache(m.GetIconMap());if(o){var l=n[o];if(l){for(var k=0;k<l.length;k++){if(l[k].iconName===j){if(l[k].iconName==="DrilldownIcon"){return l[k].iconImage}else{return l[k].iconImage+"<span style='display:none;'>"+(j)+"</span>"}}}}}return j}e.prototype.BindData=function(K){if(this.inProgress){return false}var E=this.GetJQMListId();var t=this.GetPM();var R=null;var H=0;var r=0;R=t.Get("GetScrollDir");H=t.Get("GetScrollAmount");H=parseInt(H,10);var z=t.Get("GetRecordSet").length;var j=z;var M=0;if(R!==null&&H!==0&&H<z){r=true;if(H<0){H=-H}if(R){M=z-H;this.m_Offset=this.m_Offset+H}else{M=0;j=H;this.m_Offset=this.m_Offset-H}}else{if(K){this.ClearData();this.m_Offset=0}}var k=t.Get("GetRecordSet");var J=t.Get("ListOfColumns");var Y=this.GetPM().GetProxy().GetBusComp();var F;var U=false;var w=t.Get("GetPlaceholder");var X="jqml_"+w+"_";var C;var p=J.slice();var N=0;var T=[];var I=this.GetMapFieldArray();var S=null;var P=X+"NR";if($("#"+P).length===1){$("#"+P).remove()}if(z<1){var Q=false;var G=jQuery.event.special.orientationchange.orientation();if(this.GetToggleFlag()){if($("div["+G+"='Hide']").length>0){Q=true}}var s='<div id="'+P+'" class="jqmNoRecord">';if(Q){s=s.concat('<a href="#" data-role="link">'+a+"</a></div>")}else{s=s.concat("<span>"+c+"</span></div>")}$("#scrollviewcontainer_"+w).prepend(s);if(Q){$("#"+P+" a").bind("click.SiebelAppFacade.JQMListRenderer",{ctx:this},function(Z){SiebelAppFacade.JQMLayout.ToggleMobileLayout(true)})}$("#"+P).bind("orientationchange.SiebelAppFacade.JQMListRenderer",{ctx:this},function(ab){var aa=$(this);var Z;if($("div["+ab.orientation+"='Hide']").length===0){if(aa.children("a").length===1){aa.children("a").remove();Z="<span>"+c+"</span>";aa.append(Z)}}else{if(aa.children("span").length===1&&ab.data.ctx.GetToggleFlag()){aa.children("span").remove();Z='<a href="#" data-role="link">'+a+"</a>";aa.append(Z);$("#"+aa.attr("id")+" a").bind("click.SiebelAppFacade.JQMListRenderer",{ctx:this},function(ac){SiebelAppFacade.JQMLayout.ToggleMobileLayout(true)})}}})}for(N=0;N<J.length;N++){if(N===0){F=J[N].name;S=J[N].control.GetFieldName();C=N}if(J[N].isLink){F=J[N].name;S=J[N].control.GetFieldName();U=true;C=N;break}}p.splice(C,1);for(N=0;N<p.length;N++){if(N>2){p.splice(N,p.length-N);break}}var B="";for(var V=M;V<j;V++){var D;var x=V+this.m_Offset;var n;var W="ui-icon-siebui-drilldown";var v="";D='<li id="'+X+x+'" data-role="list-content" data-jqml="true">';if(U){if(J[C].control.GetIconMap()){v=h.call(this,"DrilldownIcon",J[C].control);if(v==="DrilldownIcon"){v=""}else{W="siebui-attachment"}}if(v!==""){n="<div>"+g(W,F,V,w,v)+"</div><div>";D=D.concat(n+'<label class="ui-li-heading"><span>'+HtmlEncode(k[V][S])+"</span></label>")}else{n=g(W,F,V,w,v);D=D.concat('<label class="ui-li-heading"><span>'+HtmlEncode(k[V][S])+"</span>"+n+"</label>")}}else{if(J[C].control.GetIconMap()){var m=h.call(this,HtmlEncode(k[V][S]),J[C].control);
var q=J[C].control.GetDisplayName();D=D.concat('<p  class="ui-li-heading"><span>'+q+": </span>"+m+"</p>")}else{D=D.concat('<label class="ui-li-heading">'+HtmlEncode(k[V][S])+"</label>")}}if(I!==null){for(var o=0;o<I.length;o++){var l=HtmlEncode(k[V][I[o]]);if(!i.IsEmpty(l)){l=l.replace(/(^,)|(,$)/g,"");l=l.replace(/^\s+|\s+$/g,"")}if(!i.IsEmpty(l)){T.push(l)}}}for(N=0;N<p.length;N++){var A=p[N].control.GetDisplayName();var y=HtmlEncode(k[V][p[N].control.GetFieldName()]);if(N===0){if(p[N].control.GetIconMap()){y=h.call(this,y,p[N].control);D=D.concat("<p class='ui-li-aside'><span>"+A+": </span>"+y+"</p>")}else{D=D.concat("<p class='ui-li-aside'><span>"+A+": </span>"+y+"</p>")}}else{if(p[N].control.GetIconMap()){y=h.call(this,y,p[N].control);D=D.concat("<p><span>"+A+": </span>"+y+"</p>")}else{D=D.concat("<p><span>"+A+": </span>"+y+"</p>")}}}D=D.concat("<p class='ui-li-desc-dummy'></p>");if(U&&v!==""){D=D.concat("</div>")}D=D.concat("</li>");B=B.concat(D)}if(r){for(V=1;V<=H;V++){if(R){N=this.m_Offset-V}else{N=this.m_Offset+V+z-1}$("#"+X+N).addClass("removeli")}}var L;if(R!==null&&!R){L=this.m_Offset+H;L=X+L;$(B).insertBefore("#"+L)}else{E.append(B)}E.listview("refresh");if(r){E.children().remove(".removeli");this.SetNewscrollpos(R,H);r=false}var O=this.GetDelControl();if(O!==undefined){var u=$("#jqml_"+w+" li");if(u.length>0){$("#jqml_"+w+" li").swipeDelete({btnLabel:O.GetDisplayName(),click:function(Z){$(".menuitem").remove();Z.preventDefault();setTimeout(function(){var ae=O;var ad=ae.GetMethodPropSet();var ab=ad.Clone();var ac={};ac.async=false;ac.mask=true;ac.target=SiebelApp.S_App.GetTargetViewContainer();ac.cb=function(){var ag=Array.prototype.slice.call(arguments);if(ag[ag.length-1]===false){SiebelApp.S_App.uiStatus.Free()}};t.OnControlEvent(d.get("PHYEVENT_INVOKE_CONTROL"),O.GetMethodName(),ab,ac);var af="jqml_"+t.Get("GetPlaceholder");var aa="#"+af;$(aa+" .aSwipeBtn").remove()},0);return false}})}}this.CheckScrollboundries();this.SetMapLocationArray(T);w=null};e.prototype.GetOffset=function(n,m){n=n+this.m_Offset;m=m+this.m_Offset;var l=this.GetPM();var p=l.Get("GetPlaceholder");var k="jqml_"+p+"_";var j=k+n;var q=k+m;var o=$("#"+q).offset().top-$("#"+j).offset().top;return o};e.prototype.GetListHeight=function(){return $("#"+this.GetScrollcontainer()).children("ul").height()};e.prototype.EndLife=function(){this.SetJQMList(null);this.SetJQMListId(null);this.SetMapLocationArray(null);$("#"+this.GetPM().Get("GetPlaceholder")).undelegate("a.listdrilldown","click");$("#jqml_"+this.GetPM().Get("GetPlaceholder")).undelegate("li","click");$("#jqml_"+this.GetPM().Get("GetPlaceholder")).undelegate("li","swiperight");this.GetSearchCtrl().SetContainer(null);SiebelAppFacade.JQMListRenderer.superclass.EndLife.call(this)};e.prototype.BindEvents=function(j){SiebelAppFacade.JQMListRenderer.superclass.BindEvents.call(this,j);$("#"+this.GetPM().Get("GetPlaceholder")).delegate("a.listdrilldown","click",{ctx:this},function(u){SiebelApp.S_App.uiStatus.Busy({target:SiebelApp.S_App.GetTargetViewContainer(),mask:true});var s=u.data.ctx;var t=$(this).attr("name");var v=$(this).parents("li").eq(0).attr("id");var r=u.data.ctx.GetJQMListId().attr("id")+"_";v=parseInt(v.replace(r,""),10);v=v-u.data.ctx.m_Offset;var q=parseInt(v,10);setTimeout(function(){if(q>=0){s.SetDisableToggle(true);var w=s.OnRowSelect(q);s.SetDisableToggle(false);if(w===false||s.GetPM().OnControlEvent(d.get("PHYEVENT_DRILLDOWN"),t,q)===false){SiebelApp.S_App.uiStatus.Free();return false}}},0)});var l=this.GetPM();var p=l.Get("GetPlaceholder");var k="jqml_"+p+"_";$("#jqml_"+p).delegate("li","click",{ctx:this},function(s){$(".menuitem").remove();s.preventDefault();if($.browser.msie&&$(this).parent().data("IsSwipeRight")){$(this).parent().data("IsSwipeRight",false);return}$("div.ui-btn, .aSwipeBtn",$(this).parent("ul")).remove();var q=s.data.ctx;var r=$(this).attr("id");r=parseInt(r.replace(k,""),10);r=r-s.data.ctx.m_Offset;var t=s.target.className;if(t.indexOf("listdrilldown")!==-1){q.SetDisableToggle(true)}q.OnRowSelect(r);if(t.indexOf("listdrilldown")!==-1){q.SetDisableToggle(false)}});$("#jqml_"+p).delegate("li","swiperight",{ctx:this},function(s){$(".menuitem").remove();s.preventDefault();var q=s.data.ctx;var r=$(this).attr("id");r=parseInt(r.replace(k,""),10);r=r-s.data.ctx.m_Offset;q.SetDisableToggle(true);q.OnRowSelect(r);q.SetDisableToggle(false);if(q.GetDelBtnStatus()===false){$(this).find(".aSwipeBtn").addClass("ui-disabled")}$(this).parent().data("IsSwipeRight",true)});$("body").bind("tap",function(q){$(".aSwipeBtn").remove()});var n=this.GetMapControl();if(n!==undefined&&n!==null){if(n.GetMethodName()==="ShowMapLocations"&&typeof(google)!=="undefined"){var o=this.GetMapCtrl();var m=[];$("#"+(n.GetInputName()+"_Ctrl")).bind("click",{ctx:this,ctrl:n},function(q){var r=new SiebelApp.UIStatus();r.Busy({});setTimeout(function(){m=q.data.ctx.GetMapLocationArray();o.ShowMapLocations(m);r.Free()},0);return false})}}p=null};e.prototype.ShowSelection=function(){if(this.inProgress){return false}this.ClearSelection();var j=this.GetRowCount();var l=this.GetPM().Get("GetRowsSelectedArray");for(var k=0;k<j&&k<l.length;k++){if(l[k]){this.setSelection(k,false)}}SiebelAppFacade.JQMListRenderer.superclass.ShowSelection.call(this)};e.prototype.ClearData=function(){var k="jqml_"+this.GetPM().Get("GetPlaceholder");var j="#"+k;$(j).empty()};e.prototype.setSelection=function(l){var n="jqml_"+this.GetPM().Get("GetPlaceholder")+"_";var m=this.m_Offset+l;m=parseInt(m,10);var k=n+m;var j="#"+k;$(j).addClass("hilight");this.SetCurRowSel(l)};e.prototype.OnRowSelect=function(l){var o=false;var n=this.GetPopupType();if(n==="Assoc"){var m=this.GetPM().Get("GetRowsSelectedArray");var k=0;for(var j=0;j<m.length;j++){if(m[j]){o=true;break}}}if(this.GetToggleFlag()||n==="Assoc"||parseInt(l,10)!==this.GetCurRowSel()){SiebelApp.S_App.uiStatus.Busy({});if(this.GetPM().OnControlEvent(d.get("PHYEVENT_SELECT_ROW"),l,o)===false){SiebelApp.S_App.uiStatus.Free();return false}SiebelApp.S_App.uiStatus.Free()}return true};e.prototype.ClearSelection=function(){var k="jqml_"+this.GetPM().Get("GetPlaceholder");var j="#"+k;$(j).children(".hilight").removeClass("hilight");$(j+" .aSwipeBtn").remove()};e.prototype.ShowUIControl=function(m,l,o){SiebelAppFacade.JQMListRenderer.superclass.ShowUIControl.call(this,m,l,o);var p=m.GetUIType();var k;var n;var j=m.GetInputName();if(p===f){k=m.GetMethodName();if(k==="DeleteRecord"){n=this.GetPM().ExecuteMethod("CanInvokeMethod",k);this.SetDelControl(m);this.SetDelBtnStatus(n);$("#"+j).hide()}if(k==="ShowMapLocations"){this.SetMapControl(m)}}};e.prototype.EnableControl=function(k,j){SiebelAppFacade.JQMListRenderer.superclass.EnableControl.call(this,k,j);if(typeof(k.GetInputName)==="function"){if(k.GetUIType()===f){if(k.GetMethodName()==="DeleteRecord"){this.SetDelBtnStatus(j)}if(k.GetMethodName()==="ShowMapLocations"&&typeof(google)!=="undefined"){$("#"+k.GetInputName()+"_Ctrl").button("enable");$("#"+k.GetInputName()+"_Ctrl").addClass("showMapLocations")
}}}};e.prototype.SetCellEdit=function(j){};e.prototype.SetCellValue=function(k,l,j){};e.prototype.fixWidth=function(k){SiebelAppFacade.JQMListRenderer.superclass.fixWidth.call(this,k);if(this.IsPopup()){var j=this.GetJQMListId();if(j!==undefined){j.attr("style","max-width:"+k+" !important")}}};return e}())};
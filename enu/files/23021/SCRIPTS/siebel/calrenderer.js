if(typeof(SiebelAppFacade.CalRenderer)=="undefined"){Namespace("SiebelAppFacade.CalRenderer");SiebelAppFacade.CalRenderer=(function(){var t=SiebelApp.Utils;var p=SiebelAppFacade.FacadeConstants;var s=SiebelApp.Constants;var n=new Date();var u=new Date();var q=new Date();var j=new Array();var r;var f;var l;var v;var o;var m;var b;var a=false;var i=false;function c(x){this.superclass.constructor.call(this,x);this.GetPlaceholder=function(){var y="s_"+this.GetProxy().GetId()+"_l";this.GetPlaceholder=function(){return y};return y};k.call(this)}c.prototype.GetCurView=function(){return r};c.prototype.SetCurView=function(x){r=x};c.prototype.GetSelectedDate=function(x){return f};c.prototype.SetSelectedDate=function(x){f=x};c.prototype.GetCurStartDate=function(){return n};c.prototype.SetCurStartDate=function(x){n=x};c.prototype.GetCurEndDate=function(){return u};c.prototype.SetCurEndDate=function(x){u=x};c.prototype.GetCurShowDate=function(){return q};c.prototype.SetCurShowDate=function(x){q=x};c.prototype.GetEventInfo=function(){return j};c.prototype.GetTimezone=function(){return l};c.prototype.SetTimezone=function(x){l=x};c.prototype.GetMonthStrings=function(){return v};c.prototype.GetWeekDayStrings=function(){return o};c.prototype.GetWeekDayShortStrings=function(){return m};c.prototype.GetOwner=function(){return b};c.prototype.SetOwner=function(x){b=x;this.SetUserPermission()};c.prototype.CanInsert=function(){return(a==false)};c.prototype.CanUpdate=function(){return(i==false)};c.prototype.NoUpdate=function(){i=true};c.prototype.NoInsert=function(){a=true};c.prototype.SetUserPermission=function(){var y=this.GetUserProp("Update List");if(y!=""){var x=CCFMiscUtil_CreatePropSet();x.DecodeFromString(y);if(x.GetProperty(b)==undefined){a=true;i=true}else{a=(this.GetUserProp("No Insert")=="Y");i=(this.GetUserProp("No Update")=="Y")}}};c.prototype.GetCalControlMap=function(){return this.GetProxy().GetCalControlMap()};c.prototype.onDrillDown=function(x){this.GetProxy().InvokeMethod("DrillDown",this.DrillDownPropSet(x))};c.prototype.DrillDownPropSet=function(D){var x=CCFMiscUtil_CreatePropSet();var C=D.split("('");C=C[1].split("')");var B=C[0];x.SetProperty("Data",B);var y=q;var A=y.getTime();Month=y.getMonth()+1;Day=y.getDate();Year=y.getFullYear();var z=Month+"/"+Day+"/"+Year;x.SetProperty("CurrentDate",z);x.SetProperty("SelectedDate",A);return x};c.prototype.BindData=function(x){if(x==true){this.GetConcreteRenderer().ClearData()}this.GetConcreteRenderer().BindData()};c.prototype.ShowUI=function(){this.superclass.ShowUI.call(this)};c.prototype.CreateRenderer=function(){var y="FULLCAL";var z=SiebelAppFacade.JQFullCalRenderer;switch(y){case"FULLCAL":var x=t.InheritCtor(SiebelAppFacade.PhysicalRenderer,SiebelAppFacade.JQFullCalRenderer);this.SetConcreteRenderer(new x(this));this.GetProxy().InvokeMethod("GetCalendarDataOUI",this.PopulatePropSet());break}};c.prototype.GetCaption=function(){return SiebelApp.S_App.LookupStringCache(this.GetProxy().GetTitle())};c.prototype.SetNotify=function(y,x){if(y=="HICalendarData"){d.call(this,x)}else{this.superclass.SetNotify.call(this,y,x)}};c.prototype.PopulatePropSet=function(){var A=n.getMonth()+1;var E=n.getDate();var z=n.getFullYear();var y=A+"/"+E+"/"+z;A=u.getMonth()+1;E=u.getDate();z=u.getFullYear();var D=A+"/"+E+"/"+z;A=q.getMonth()+1;E=q.getDate();z=q.getFullYear();var B=A+"/"+E+"/"+z;var C=q.getTime();var x=CCFMiscUtil_CreatePropSet();x.SetProperty("ViewMode","2");x.SetProperty("ClippingCount","4");x.SetProperty("SelectedDate",C);x.SetProperty("StartDate",y);x.SetProperty("EndDate",D);x.SetProperty("CurrentDate",B);x.SetProperty("StretchCell",this.GetUserProp("StretchCell"));x.SetProperty("SelectedTimeZone",this.GetTimezone());x.SetProperty("SelectedUser",this.GetOwner());return x};c.prototype.GetUserProp=function(x){return this.GetProxy().GetUserPrefPropset().GetProperty(x)};c.prototype.CanDnD=function(y){var x=false;if(y.readOnly=="N"){x=true}return x};c.prototype.updateEvent=function(M,B,N,K,y,z,J){var G=CCFMiscUtil_CreatePropSet();var O=CCFMiscUtil_CreatePropSet();var D=this.GetUserProp("UISTR Repeating Dialog Label 1");var C=this.GetUserProp("UISTR Repeating Dialog Label 2");var E=this.GetUserProp("UISTR Repeating Dialog This Instance");var I=this.GetUserProp("UISTR Repeating Dialog All Future Instances");var P=this.GetUserProp("UISTR Repeating Dialog OK Button");var A=this.GetUserProp("UISTR Repeating Dialog Cancel Button");if(this.CanDnD(M)==false){z();return}G.SetProperty("NewStartDate",$.fullCalendar.formatDate(M.start,"MM/dd/yyyy HH:mm:ss"));G.SetProperty("RowId",M.calendarId);if(y=="Resize"){G.SetProperty("NewEndDate",$.fullCalendar.formatDate(M.end,"MM/dd/yyyy HH:mm:ss"))}var L='<p><font face="verdana" size="3">'+D+"<br /><br />";L=L+C+"<br />";L=L+'<input type="radio" name="userchoice" id="SaveThisOneId" value="SaveThisOne" checked="checked" />'+E+"<br />";L=L+'<input type="radio" name="userchoice" id="SaveAllId" value="SaveAll" />'+I;L=L+"<br /></font></p>";var F=this;var Q=$("<div></div>").html(L).dialog({autoOpen:false,title:"Repeating Event Dialog",height:250,width:350,modal:true,resizable:false,buttons:{OK:{text:P,click:function(){var R=$("input:radio[name=userchoice]:checked").val();if(R=="SaveThisOne"){O.SetProperty("Repeating","Y");O.SetProperty("Modify","ThisOne");G.SetProperty("Optional",O.EncodeAsString());F.GetProxy().InvokeMethod("UpdateRecord",G);J();Q.dialog("close")}else{if(R=="SaveAll"){O.SetProperty("Repeating","Y");O.SetProperty("Modify","AllFuture");G.SetProperty("Optional",O.EncodeAsString());F.GetProxy().InvokeMethod("UpdateRecord",G);J();Q.dialog("close")}else{z();Q.dialog("close")}}}},Cancel:{text:A,click:function(){z();Q.dialog("close")}}}});var H=M.repeating;var x=this.GetUserProp("UISTR Label Change Confirmation");if(H=="N"){this.GetProxy().InvokeMethod("UpdateRecord",G);J()}else{Q.dialog("open")}};function k(){this.SetTimezone(this.GetUserProp("Default Timezone"));var x=this.GetUserProp("Default User");if(x==null||x==""){this.SetOwner(this.GetUserProp("User Login Name"))}else{this.SetOwner(x)}e.call(this);h.call(this);g.call(this)}function e(){v=new Array(this.GetUserProp("UISTR January"),this.GetUserProp("UISTR February"),this.GetUserProp("UISTR March"),this.GetUserProp("UISTR April"),this.GetUserProp("UISTR May"),this.GetUserProp("UISTR June"),this.GetUserProp("UISTR July"),this.GetUserProp("UISTR August"),this.GetUserProp("UISTR September"),this.GetUserProp("UISTR October"),this.GetUserProp("UISTR November"),this.GetUserProp("UISTR December"))}function h(){o=new Array(this.GetUserProp("UISTR Sunday"),this.GetUserProp("UISTR Monday"),this.GetUserProp("UISTR Tuesday"),this.GetUserProp("UISTR Wednesday"),this.GetUserProp("UISTR Thursday"),this.GetUserProp("UISTR Friday"),this.GetUserProp("UISTR Saturday"))}function g(){m=new Array(this.GetUserProp("UISTR Sunday"),this.GetUserProp("UISTR Monday"),this.GetUserProp("UISTR Tuesday"),this.GetUserProp("UISTR Wednesday"),this.GetUserProp("UISTR Thursday"),this.GetUserProp("UISTR Friday"),this.GetUserProp("UISTR Saturday"))
}function w(C){var F=C.GetProperty("0").split("<DIV");var G=F[0];var z=F.splice(1);j=j.splice();for(var H=0;H<z.length;H++){var E=z[H].split("Type:")[1].split("Description:");var B=E[0];E=E[1].split("Start Time:");var K=E[0].replace(new RegExp("\n","g"),"").replace(/^\s+|\s+$/g,"");E=E[1].split("End Time:");var D=new Date(Date.parse(E[0]));E=E[1].split("Meeting Location:");var I=new Date(Date.parse(E[0]));E=E[1].split("Comment:");var J=E[0].replace(new RegExp("\n","g"),"").replace(/^\s+|\s+$/g,"");var A=E[1].split("%23")[2];A=A.substring(0,A.length-1).replace(/%2f/g,"/");E=E[1].split("HREF=");E=E[1].split(">");var y=E[0];y=y.replace(/%2f/g,"/");y=y.replace(/%23/g,"#");var x=new Array();x.Id=A;x.Description=K;x.Planned=D;x.PlannedCompletion=I;j.push(x)}}function d(C){var I=CCFMiscUtil_CreatePropSet();var H=CCFMiscUtil_CreatePropSet();var B=CCFMiscUtil_CreatePropSet();var M=C.GetProperty("0");var J=I.DecodeFromString(M);if(J==false||I.type!="OUICalendarData"){return}if(I.PropertyExists("ReturnStartDate")){var G=I.GetProperty("ReturnStartDate");f=$.fullCalendar.parseDate(G)}var K=I.GetChildCount("CalendarEvent");j=j.splice();for(var F=0;F<K;F++){H=I.GetChild(F);if(H.type!="CalendarEvent"){continue}var z=new Array();var D=H.EnumProperties(true);do{z[D]=$.jgrid.htmlDecode(H.GetProperty(D));if(D=="Drilldown"){var y=$.jgrid.htmlDecode(H.GetProperty(D));y=y.replace(/%2f/g,"/");y=y.replace(/%23/g,"#");y="javaScript:void(0)('"+y+"')";z[D]=y}}while(D=H.EnumProperties(false));var E=new Array();var A=H.GetChildCount("Icon");for(var L=0;L<A;L++){B=H.GetChild(L);if(B.type!="Icon"){continue}var x=new Array();x.Name=$.jgrid.htmlDecode(B.value);x.FilePath=$.jgrid.htmlDecode(B.GetProperty("IconFile"));x.AltText=$.jgrid.htmlDecode(B.GetProperty("AltText"));E.push(x)}z.Icons=E;j.push(z)}}return c}())};
/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2013 Oracle and/or its affiliates. All rights reserved.
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
if(typeof(SiebelApp.S_App.CustomToolbar)==="undefined"){Namespace("SiebelApp.S_App.CustomToolbar");SiebelApp.S_App.CustomToolbar=(function(){var c;var b=SiebelJS.Dependency("SiebelApp.Utils");var d=SiebelApp.Constants;var a=SiebelApp.Offlineconstants;function e(){var f;g=function g(){return f};g.prototype=this;f=new g();f.constructor=g;return f}c=new e();e.prototype.Init=function(){var g=document.getElementById("GoOffline");if(g){if(IsOfflineModeEnabled()){var f="<div data-role='popup' id='popupMenu' data-theme='a'><div data-role='popup' id='popupLogin' data-theme='a' class='ui-corner-all' data-dismissible='false'><form><div style='padding:10px 20px;'><h3>";f=f+"Please enter password</h3>";f=f+"<label for='pw' class='ui-hidden-accessible'>Password:</label><input name='pass' class='ui-input-text ui-corner-all ui-body-e' id='pw' value='' data-theme='e' type='password' />";f=f+"<a href='#' data-role='button' data-theme='b' data-icon='delete' id='Cancel' data-inline='true' data-rel='back'>Cancel</a>";f=f+"<a href='#' data-role='button' data-theme='c' data-icon='check' id = 'Ok' data-inline='true' data-rel='back'>Ok</a>";f=f+"</div></form></div></div>";if(SiebelApp.OfflineAppSettings.GetMode()){$("div[id='GoOffline']").append('<a href="#popupLogin" id="Offline" data-rel="popup" data-position-to="origin" data-transition= "pop"><img src = "images/GoOffline.png"></a>');$("#GoOffline").find("img").attr("title","Go Online");$("div #GoOffline").find("a").append("<img class = 'stati' src='images/white.gif'></img>");$("div #GoOffline").find("a").append(f);$("div[id='GoOffline']").trigger("create")}else{$("div[id='GoOffline']").append('<a href="#popupLogin" id="Online"  data-rel="popup" data-position-to="origin" data-transition= "pop"><img src = "images/GoOnline.png"></a>');$("#GoOffline").find("img").attr("title","Go Offline");$("div #GoOffline").find("a").append("<img class = 'stati' src='images/white.gif'></img>");$("div #GoOffline").find("a").append(f);$("div[id='GoOffline']").trigger("create")}g.onclick=function(){var p;if(SiebelApp.SyncThreadHandler.SyncInProgress()){alert(SiebelApp.S_App.OfflineLocaleObject.GetLocalString("SSASqlErrTrxInProgress"));return false}if(!SiebelApp.BrowserCacheMgr.GetBrowserStorage()){p=SiebelApp.S_App.OfflineLocaleObject.GetLocalString("IDS_DOUI_ERR_INSUFFICIENT_MEMORY");alert(p);return false}if(!b.IsEmpty(SiebelApp.S_App.Model.GetLoginName())&&SiebelApp.S_App.Model.GetLoginName()!==SiebelApp.S_App.GetUserName()){alert(SiebelApp.S_App.OfflineLocaleObject.GetLocalString("IDS_DOUI_ERR_UNAUTH_USER"));return false}if(!SiebelApp.OfflineAppSettings.GetMode()){if(navigator.onLine){if(SiebelApp.S_App.GetTimer()){var i=JSON.parse(window.localStorage.getItem(d.get("SWE_PERF_LOG_DATA")));if(i){var o=this;var h=SiebelApp.S_App.GetPageURL();var m=SiebelApp.S_App.GetSRN();h=h+"?SWECmd=InvokeMethod&SWEMethod=WritePerfLog&SRN="+m;var j=""+d.get("SWE_PERF_LOG_DATA")+"="+URLEncode(i);$.ajax({type:"POST",url:h,data:j,processData:false,complete:function(q,t,r){if(t!=="error"&&SiebelApp.OfflineAppMgr.CheckServerConnection(q.responseText)){window.localStorage.removeItem(d.get("SWE_PERF_LOG_DATA"));SiebelApp.S_App.CustomToolbar.GiveLoginPopup.call(o)}else{if(SiebelApp.OfflineAppSettings.GetPkgStatus()){SiebelApp.OfflineAppSettings.OnSuccessfulDataDownload();var s=window.location;s.replace(s.origin.concat(s.pathname));return false}else{alert(SiebelApp.S_App.OfflineLocaleObject.GetLocalString("IDS_DOUI_ERR_SYNC"));return false}}}})}else{SiebelApp.S_App.CustomToolbar.GiveLoginPopup.call(this)}}else{SiebelApp.S_App.CustomToolbar.GiveLoginPopup.call(this)}}else{if(SiebelApp.OfflineAppSettings.GetPkgStatus()){SiebelApp.OfflineAppSettings.OnSuccessfulDataDownload();var n=window.location;n.replace(n.origin.concat(n.pathname));return false}else{alert(SiebelApp.S_App.OfflineLocaleObject.GetLocalString("IDS_DOUI_ERR_OFFLINE_PKG"));return false}}}else{if(navigator.onLine){if(SiebelApp.OfflineAppSettings.GetSyncStatus()){SiebelApp.S_App.CustomToolbar.GiveLoginPopup.call(this)}else{var l=SiebelApp.S_App.GetPageURL();var k=SiebelApp.S_App.GetSRN();l=l+"?SWECmd=Ping&SRN="+k;$.ajax({type:"POST",url:l,success:function(r,s,q){if(SiebelApp.OfflineAppMgr.CheckServerConnection(r)){SiebelApp.ProactiveCacheBuilder.ProcessGoOnline()}else{alert(SiebelApp.S_App.OfflineLocaleObject.GetLocalString("IDS_DOUI_ERR_SYNC"))}return false},complete:function(q,s,r){if(s==="error"){alert(SiebelApp.S_App.OfflineLocaleObject.GetLocalString("IDS_DOUI_ERR_SYNC"))}return false}});return false}}else{if(SiebelApp.OfflineAppSettings.GetSyncStatus()){p=SiebelApp.S_App.OfflineLocaleObject.GetLocalString("IDS_DOUI_ERR_NETWORK_CONN");alert(p)}else{alert(SiebelApp.S_App.OfflineLocaleObject.GetLocalString("IDS_DOUI_ERR_INTERN_CONN"))}return false}}};if(SiebelApp.OfflineAppSettings.GetSyncStatus()===true){if(SiebelApp.S_App.GetUserName()===SiebelApp.S_App.Model.GetLoginName()){this.Update("SyncPendng")}}}else{$("div[id='GoOffline']").addClass("siebui-StateButton");$("div[id='Sync']").addClass("siebui-StateButton")}}};e.prototype.GiveLoginPopup=function(){$("#pw").val("");$("#Ok").unbind("click",f);$("#Cancel").unbind("click",g);var f=function(){var h={};h.pwd=$("#pw").val();if(h.pwd!==""){h.url="request";h.type="GET";h.async=true;$("#pw").val("");$("#Ok").unbind("click",f);$("#Cancel").unbind("click",g);SiebelApp.SyncThreadHandler.OnCall(h)}else{alert(SiebelApp.S_App.OfflineLocaleObject.GetLocalString("IDS_SWE_INVALID_OLD_PASSWORD"));return false}};var g=function(){$("#pw").val("");$("#Ok").unbind("click",f);$("#Cancel").unbind("click",g)};$("#pw").focus();$("#Ok").bind("click",f);$("#Cancel").bind("click",g)};e.prototype.Update=function(f){var g=document.getElementById("GoOffline");if(g){if(IsOfflineModeEnabled()){if(f==="FullDownLoad"){$("div #GoOffline").find(".stati").removeClass().addClass("stati statusFullDownLoad")}else{if(f==="FullDownLoadFailed"){$("div #GoOffline").find(".stati").removeClass().addClass("stati statusFullDownLoadFailed")}else{if(SiebelApp.OfflineAppSettings.GetSyncStatus()===true&&f==="SyncPendng"){$("div #GoOffline").find(".stati").removeClass().addClass("stati statusSyncPending")}else{if(f==="IncDataDownLoad"){$("div #GoOffline").find(".stati").removeClass().addClass("stati statusIncDataDownLoad")}else{if(f==="IncDownLoadFailed"){$("div #GoOffline").find(".stati").removeClass().addClass("stati statusIncDownLoadFailed")}else{if(f==="UpSync"){$("div #GoOffline").find(".stati").removeClass().addClass("stati statusUpSync")}else{if(f==="UpSyncFailed"){$("div #GoOffline").find(".stati").removeClass().addClass("stati statusUpSyncFailed")}else{if(f==="UpSyncDataConflict"){$("div #GoOffline").find(".stati").removeClass().addClass("stati statusSyncPendingSec")}else{if(f==="UpSyncDone"){$("div #GoOffline").find(".stati").removeClass().addClass("stati statusSyncPendingSec")}else{if(f==="DownLoadFailed"){if($("div #GoOffline").find(".statusFullDownLoad").length){$("div #GoOffline").find(".statusFullDownLoad").removeClass().addClass("stati statusFullDownLoadFailed")
}else{if($("div #GoOffline").find(".statusIncDataDownLoad").length){$("div #GoOffline").find(".stati").removeClass().addClass("stati statusIncDownLoadFailed")}else{if($("div #GoOffline").find(".statusUpSync").length){$("div #GoOffline").find(".stati").removeClass().addClass("stati statusUpSyncFailed")}}}}else{$("#Sync").find("img").attr("title","No Data to Sync");$("#Sync").find("img").attr("src","images/SyncNotPending.png")}}}}}}}}}}}}};$(document).bind("keypress",function(g){var f=g?g.which:window.event.keyCode;if($("#popupLogin").parent().hasClass("ui-popup-active")){if(f===a.get("KEYCODE_ENTER")){g.preventDefault();g.stopPropagation();$("#popupLogin").popup("close");var h={};h.pwd=$("#pw").val();if(h.pwd!==""){h.url="request";h.type="GET";h.async=true;$("#pw").val("");SiebelApp.SyncThreadHandler.OnCall(h)}else{alert(SiebelApp.S_App.OfflineLocaleObject.GetLocalString("IDS_SWE_INVALID_OLD_PASSWORD"));return false}}}});return c}())};